<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Synpatic Plasticity | Introduction to Computational Neuroscience</title>
  <meta name="description" content="9 Synpatic Plasticity | Introduction to Computational Neuroscience" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Synpatic Plasticity | Introduction to Computational Neuroscience" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Synpatic Plasticity | Introduction to Computational Neuroscience" />
  
  
  

<meta name="author" content="Matthew J. Crossley" />


<meta name="date" content="2024-02-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="neurotransmitter-release.html"/>
<link rel="next" href="reinforcement-learning.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the book</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html"><i class="fa fa-check"></i><b>2</b> Introduction to the book</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#what-is-computational-neuroscience"><i class="fa fa-check"></i><b>2.1</b> What is computational neuroscience?</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#marrs-levels"><i class="fa fa-check"></i><b>2.2</b> Marr’s levels</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#why-computers"><i class="fa fa-check"></i><b>2.3</b> Why computers?</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#what-is-the-real-value-gained"><i class="fa fa-check"></i><b>2.4</b> What is the real value gained?</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#why-python"><i class="fa fa-check"></i><b>2.5</b> Why Python</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#getting-started-with-python"><i class="fa fa-check"></i><b>2.6</b> Getting started with Python</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#learning-python"><i class="fa fa-check"></i><b>2.7</b> Learning Python</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="numpy-and-matplotlib.html"><a href="numpy-and-matplotlib.html"><i class="fa fa-check"></i><b>3</b> Numpy and Matplotlib</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numpy-and-matplotlib.html"><a href="numpy-and-matplotlib.html#learning-python-1"><i class="fa fa-check"></i><b>3.1</b> Learning Python</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intro-to-calculus.html"><a href="intro-to-calculus.html"><i class="fa fa-check"></i><b>4</b> Intro to calculus</a></li>
<li class="chapter" data-level="5" data-path="intro-to-dynamical-systems.html"><a href="intro-to-dynamical-systems.html"><i class="fa fa-check"></i><b>5</b> Intro to dynamical systems</a>
<ul>
<li class="chapter" data-level="5.1" data-path="intro-to-dynamical-systems.html"><a href="intro-to-dynamical-systems.html#differential-equations"><i class="fa fa-check"></i><b>5.1</b> Differential equations</a></li>
<li class="chapter" data-level="5.2" data-path="intro-to-dynamical-systems.html"><a href="intro-to-dynamical-systems.html#eulers-method"><i class="fa fa-check"></i><b>5.2</b> Euler’s method</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html"><i class="fa fa-check"></i><b>6</b> Simple neuron models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html#review-of-hh"><i class="fa fa-check"></i><b>6.1</b> Review of HH</a></li>
<li class="chapter" data-level="6.2" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html#leaky-integrate-and-fire"><i class="fa fa-check"></i><b>6.2</b> Leaky integrate and fire</a></li>
<li class="chapter" data-level="6.3" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html#quadratic-integrate-and-fire"><i class="fa fa-check"></i><b>6.3</b> Quadratic integrate and fire</a></li>
<li class="chapter" data-level="6.4" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html#izhikevich-neuron"><i class="fa fa-check"></i><b>6.4</b> Izhikevich Neuron</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html"><i class="fa fa-check"></i><b>7</b> Hodgkin-Huxley neuron model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_1"><i class="fa fa-check"></i><b>7.1</b> neuron_func_1</a></li>
<li class="chapter" data-level="7.2" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_2"><i class="fa fa-check"></i><b>7.2</b> neuron_func_2</a></li>
<li class="chapter" data-level="7.3" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_3"><i class="fa fa-check"></i><b>7.3</b> neuron_func_3</a></li>
<li class="chapter" data-level="7.4" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_4"><i class="fa fa-check"></i><b>7.4</b> neuron_func_4</a></li>
<li class="chapter" data-level="7.5" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_5"><i class="fa fa-check"></i><b>7.5</b> neuron_func_5</a></li>
<li class="chapter" data-level="7.6" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_6"><i class="fa fa-check"></i><b>7.6</b> neuron_func_6</a></li>
<li class="chapter" data-level="7.7" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_7"><i class="fa fa-check"></i><b>7.7</b> neuron_func_7</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html"><i class="fa fa-check"></i><b>8</b> Neurotransmitter release</a>
<ul>
<li class="chapter" data-level="8.1" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#synaptics-responses"><i class="fa fa-check"></i><b>8.1</b> Synaptics responses</a></li>
<li class="chapter" data-level="8.2" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#spikes-as-a-change-in-conductance"><i class="fa fa-check"></i><b>8.2</b> Spikes as a change in conductance</a></li>
<li class="chapter" data-level="8.3" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#coupling-conductance-to-psp"><i class="fa fa-check"></i><b>8.3</b> Coupling conductance to PSP</a></li>
<li class="chapter" data-level="8.4" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#psps-superimpose"><i class="fa fa-check"></i><b>8.4</b> PSPs superimpose</a></li>
<li class="chapter" data-level="8.5" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#psp-model-in-the-izhikevich-neuron"><i class="fa fa-check"></i><b>8.5</b> PSP model in the Izhikevich neuron</a></li>
<li class="chapter" data-level="8.6" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#chaining-neurons-together"><i class="fa fa-check"></i><b>8.6</b> Chaining neurons together</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html"><i class="fa fa-check"></i><b>9</b> Synpatic Plasticity</a>
<ul>
<li class="chapter" data-level="9.1" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#python-helper-functions"><i class="fa fa-check"></i><b>9.1</b> Python helper functions</a></li>
<li class="chapter" data-level="9.2" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#hebbian-learning-1"><i class="fa fa-check"></i><b>9.2</b> Hebbian Learning 1</a></li>
<li class="chapter" data-level="9.3" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#hebbian-learning-2"><i class="fa fa-check"></i><b>9.3</b> Hebbian Learning 2</a></li>
<li class="chapter" data-level="9.4" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#hebbian-learning-3"><i class="fa fa-check"></i><b>9.4</b> Hebbian Learning 3</a></li>
<li class="chapter" data-level="9.5" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#hebbian-stdp"><i class="fa fa-check"></i><b>9.5</b> Hebbian STDP</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reinforcement-learning.html"><a href="reinforcement-learning.html"><i class="fa fa-check"></i><b>10</b> Reinforcement Learning</a></li>
<li class="chapter" data-level="11" data-path="reinforcement-learning-rule.html"><a href="reinforcement-learning-rule.html"><i class="fa fa-check"></i><b>11</b> Reinforcement learning rule</a></li>
<li class="chapter" data-level="12" data-path="example-1.html"><a href="example-1.html"><i class="fa fa-check"></i><b>12</b> Example 1</a></li>
<li class="chapter" data-level="13" data-path="example-2.html"><a href="example-2.html"><i class="fa fa-check"></i><b>13</b> Example 2</a></li>
<li class="chapter" data-level="14" data-path="example-3.html"><a href="example-3.html"><i class="fa fa-check"></i><b>14</b> Example 3</a>
<ul>
<li class="chapter" data-level="14.1" data-path="example-3.html"><a href="example-3.html#reinforcement-learning-framework"><i class="fa fa-check"></i><b>14.1</b> Reinforcement learning framework</a></li>
<li class="chapter" data-level="14.2" data-path="example-3.html"><a href="example-3.html#estimating-the-state-value-function"><i class="fa fa-check"></i><b>14.2</b> Estimating the state-value function</a></li>
<li class="chapter" data-level="14.3" data-path="example-3.html"><a href="example-3.html#temporal-difference-td-learning"><i class="fa fa-check"></i><b>14.3</b> Temporal difference (TD) learning</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="example-3.html"><a href="example-3.html#td-rl-model-of-classical-conditioning"><i class="fa fa-check"></i><b>14.3.1</b> TD RL model of classical conditioning</a></li>
<li class="chapter" data-level="14.3.2" data-path="example-3.html"><a href="example-3.html#td-rl-as-the-learning-signal-in-a-spiking-network"><i class="fa fa-check"></i><b>14.3.2</b> TD RL as the learning signal in a spiking network</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="example-3.html"><a href="example-3.html#td0-for-estimating-v_pi"><i class="fa fa-check"></i><b>14.4</b> TD(0) for estimating <span class="math inline">\(v_{\pi}\)</span></a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="example-3.html"><a href="example-3.html#td-in-a-simple-2-arm-bandit-task"><i class="fa fa-check"></i><b>14.4.1</b> TD in a simple 2-arm bandit task</a></li>
<li class="chapter" data-level="14.4.2" data-path="example-3.html"><a href="example-3.html#action-selection-policy"><i class="fa fa-check"></i><b>14.4.2</b> Action selection policy</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="example-3.html"><a href="example-3.html#sarsa-for-estimating-q"><i class="fa fa-check"></i><b>14.5</b> SARSA for estimating <span class="math inline">\(Q\)</span></a></li>
<li class="chapter" data-level="14.6" data-path="example-3.html"><a href="example-3.html#q-learning-for-estimating-pi"><i class="fa fa-check"></i><b>14.6</b> Q-learning for estimating <span class="math inline">\(\pi\)</span></a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="example-3.html"><a href="example-3.html#q-learning-applied-to-instrumental-conditioning"><i class="fa fa-check"></i><b>14.6.1</b> Q-learning applied to instrumental conditioning</a></li>
<li class="chapter" data-level="14.6.2" data-path="example-3.html"><a href="example-3.html#q-learning-applied-to-instrumental-conditioning-2"><i class="fa fa-check"></i><b>14.6.2</b> Q-learning applied to instrumental conditioning 2</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="example-3.html"><a href="example-3.html#dyna-q-model-based-rl"><i class="fa fa-check"></i><b>14.7</b> Dyna-Q: Model-based RL</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="example-3.html"><a href="example-3.html#dyna-q-applied-to-instrumental-conditioning"><i class="fa fa-check"></i><b>14.7.1</b> Dyna-Q applied to instrumental conditioning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>15</b> supervised learning</a></li>
<li class="chapter" data-level="16" data-path="supervised-learning-1.html"><a href="supervised-learning-1.html"><i class="fa fa-check"></i><b>16</b> Supervised Learning</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Computational Neuroscience</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="synpatic-plasticity" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Synpatic Plasticity<a href="synpatic-plasticity.html#synpatic-plasticity" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li><p>Synaptic plasticity refers to changes in the connection
weights between neurons.</p></li>
<li><p>Long-term potentiation (LTP) is synaptic strengthening.</p></li>
<li><p>Long-term depression (LTD) is synaptic strengthening.</p></li>
<li><p>Synaptic plasticity comes in many different forms and
operates by different computational principles in different
brain regions and between different cell types.</p></li>
<li><p>In this lecture, we will explore a few different types of
<strong>Hebbian</strong> synaptic plasticity.</p></li>
</ul>
<div id="python-helper-functions" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Python helper functions<a href="synpatic-plasticity.html#python-helper-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>We will simulate a two neuron network in which neuron 1
projects to neuron 2, the first neuron is driven by an
external input, and the connection weight between neuron 1
and neuron 2 is plastic.</p></li>
<li><p>Since we will vary the rules that govern plasticity
between neuron 1 and neuron 2, we will first write a bit of
<code>python</code> code that will help us avoid rewriting the same
lines of code over and over.</p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="synpatic-plasticity.html#cb20-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-2"><a href="synpatic-plasticity.html#cb20-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-3"><a href="synpatic-plasticity.html#cb20-3" tabindex="-1"></a><span class="im">import</span> matplotlib.gridspec <span class="im">as</span> gridspec</span>
<span id="cb20-4"><a href="synpatic-plasticity.html#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="synpatic-plasticity.html#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="synpatic-plasticity.html#cb20-6" tabindex="-1"></a><span class="kw">def</span> init_arrays():</span>
<span id="cb20-7"><a href="synpatic-plasticity.html#cb20-7" tabindex="-1"></a>    v1 <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-8"><a href="synpatic-plasticity.html#cb20-8" tabindex="-1"></a>    u1 <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-9"><a href="synpatic-plasticity.html#cb20-9" tabindex="-1"></a>    g1 <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-10"><a href="synpatic-plasticity.html#cb20-10" tabindex="-1"></a>    spike1 <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-11"><a href="synpatic-plasticity.html#cb20-11" tabindex="-1"></a>    v1[<span class="dv">0</span>] <span class="op">=</span> vr</span>
<span id="cb20-12"><a href="synpatic-plasticity.html#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="synpatic-plasticity.html#cb20-13" tabindex="-1"></a>    v2 <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-14"><a href="synpatic-plasticity.html#cb20-14" tabindex="-1"></a>    u2 <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-15"><a href="synpatic-plasticity.html#cb20-15" tabindex="-1"></a>    g2 <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-16"><a href="synpatic-plasticity.html#cb20-16" tabindex="-1"></a>    spike2 <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-17"><a href="synpatic-plasticity.html#cb20-17" tabindex="-1"></a>    v2[<span class="dv">0</span>] <span class="op">=</span> vr</span>
<span id="cb20-18"><a href="synpatic-plasticity.html#cb20-18" tabindex="-1"></a></span>
<span id="cb20-19"><a href="synpatic-plasticity.html#cb20-19" tabindex="-1"></a>    w_01 <span class="op">=</span> <span class="fl">0.4</span> <span class="op">*</span> np.ones(n_trials)</span>
<span id="cb20-20"><a href="synpatic-plasticity.html#cb20-20" tabindex="-1"></a>    w_12 <span class="op">=</span> <span class="fl">0.4</span> <span class="op">*</span> np.ones(n_trials)</span>
<span id="cb20-21"><a href="synpatic-plasticity.html#cb20-21" tabindex="-1"></a></span>
<span id="cb20-22"><a href="synpatic-plasticity.html#cb20-22" tabindex="-1"></a>    g_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb20-23"><a href="synpatic-plasticity.html#cb20-23" tabindex="-1"></a>    v1_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb20-24"><a href="synpatic-plasticity.html#cb20-24" tabindex="-1"></a>    g1_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb20-25"><a href="synpatic-plasticity.html#cb20-25" tabindex="-1"></a>    v2_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb20-26"><a href="synpatic-plasticity.html#cb20-26" tabindex="-1"></a>    g2_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb20-27"><a href="synpatic-plasticity.html#cb20-27" tabindex="-1"></a></span>
<span id="cb20-28"><a href="synpatic-plasticity.html#cb20-28" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb20-29"><a href="synpatic-plasticity.html#cb20-29" tabindex="-1"></a>        <span class="st">&#39;v1&#39;</span>: v1,</span>
<span id="cb20-30"><a href="synpatic-plasticity.html#cb20-30" tabindex="-1"></a>        <span class="st">&#39;u1&#39;</span>: u1,</span>
<span id="cb20-31"><a href="synpatic-plasticity.html#cb20-31" tabindex="-1"></a>        <span class="st">&#39;g1&#39;</span>: g1,</span>
<span id="cb20-32"><a href="synpatic-plasticity.html#cb20-32" tabindex="-1"></a>        <span class="st">&#39;spike1&#39;</span>: spike1,</span>
<span id="cb20-33"><a href="synpatic-plasticity.html#cb20-33" tabindex="-1"></a>        <span class="st">&#39;v2&#39;</span>: v2,</span>
<span id="cb20-34"><a href="synpatic-plasticity.html#cb20-34" tabindex="-1"></a>        <span class="st">&#39;u2&#39;</span>: u2,</span>
<span id="cb20-35"><a href="synpatic-plasticity.html#cb20-35" tabindex="-1"></a>        <span class="st">&#39;g2&#39;</span>: g2,</span>
<span id="cb20-36"><a href="synpatic-plasticity.html#cb20-36" tabindex="-1"></a>        <span class="st">&#39;spike2&#39;</span>: spike2,</span>
<span id="cb20-37"><a href="synpatic-plasticity.html#cb20-37" tabindex="-1"></a>        <span class="st">&#39;w_01&#39;</span>: w_01,</span>
<span id="cb20-38"><a href="synpatic-plasticity.html#cb20-38" tabindex="-1"></a>        <span class="st">&#39;w_12&#39;</span>: w_12,</span>
<span id="cb20-39"><a href="synpatic-plasticity.html#cb20-39" tabindex="-1"></a>        <span class="st">&#39;g_record&#39;</span>: g_record,</span>
<span id="cb20-40"><a href="synpatic-plasticity.html#cb20-40" tabindex="-1"></a>        <span class="st">&#39;v1_record&#39;</span>: v1_record,</span>
<span id="cb20-41"><a href="synpatic-plasticity.html#cb20-41" tabindex="-1"></a>        <span class="st">&#39;g1_record&#39;</span>: g1_record,</span>
<span id="cb20-42"><a href="synpatic-plasticity.html#cb20-42" tabindex="-1"></a>        <span class="st">&#39;v2_record&#39;</span>: v2_record,</span>
<span id="cb20-43"><a href="synpatic-plasticity.html#cb20-43" tabindex="-1"></a>        <span class="st">&#39;g2_record&#39;</span>: g2_record</span>
<span id="cb20-44"><a href="synpatic-plasticity.html#cb20-44" tabindex="-1"></a>    }</span>
<span id="cb20-45"><a href="synpatic-plasticity.html#cb20-45" tabindex="-1"></a></span>
<span id="cb20-46"><a href="synpatic-plasticity.html#cb20-46" tabindex="-1"></a></span>
<span id="cb20-47"><a href="synpatic-plasticity.html#cb20-47" tabindex="-1"></a><span class="kw">def</span> plot_results():</span>
<span id="cb20-48"><a href="synpatic-plasticity.html#cb20-48" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb20-49"><a href="synpatic-plasticity.html#cb20-49" tabindex="-1"></a>    gs <span class="op">=</span> gridspec.GridSpec(<span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb20-50"><a href="synpatic-plasticity.html#cb20-50" tabindex="-1"></a></span>
<span id="cb20-51"><a href="synpatic-plasticity.html#cb20-51" tabindex="-1"></a>    ax00 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb20-52"><a href="synpatic-plasticity.html#cb20-52" tabindex="-1"></a>    ax10 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb20-53"><a href="synpatic-plasticity.html#cb20-53" tabindex="-1"></a>    ax20 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">2</span>, <span class="dv">0</span>])</span>
<span id="cb20-54"><a href="synpatic-plasticity.html#cb20-54" tabindex="-1"></a>    ax01 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb20-55"><a href="synpatic-plasticity.html#cb20-55" tabindex="-1"></a>    ax11 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb20-56"><a href="synpatic-plasticity.html#cb20-56" tabindex="-1"></a>    ax21 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb20-57"><a href="synpatic-plasticity.html#cb20-57" tabindex="-1"></a>    ax3 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">3</span>, :])</span>
<span id="cb20-58"><a href="synpatic-plasticity.html#cb20-58" tabindex="-1"></a></span>
<span id="cb20-59"><a href="synpatic-plasticity.html#cb20-59" tabindex="-1"></a>    ax1 <span class="op">=</span> ax00</span>
<span id="cb20-60"><a href="synpatic-plasticity.html#cb20-60" tabindex="-1"></a>    ax2 <span class="op">=</span> ax00.twinx()</span>
<span id="cb20-61"><a href="synpatic-plasticity.html#cb20-61" tabindex="-1"></a>    ax2.plot(t, g_record[<span class="dv">0</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;external g&#39;</span>)</span>
<span id="cb20-62"><a href="synpatic-plasticity.html#cb20-62" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb20-63"><a href="synpatic-plasticity.html#cb20-63" tabindex="-1"></a>    ax1.set_title(<span class="st">&#39;Trial 1&#39;</span>)</span>
<span id="cb20-64"><a href="synpatic-plasticity.html#cb20-64" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb20-65"><a href="synpatic-plasticity.html#cb20-65" tabindex="-1"></a></span>
<span id="cb20-66"><a href="synpatic-plasticity.html#cb20-66" tabindex="-1"></a>    ax1 <span class="op">=</span> ax10</span>
<span id="cb20-67"><a href="synpatic-plasticity.html#cb20-67" tabindex="-1"></a>    ax2 <span class="op">=</span> ax10.twinx()</span>
<span id="cb20-68"><a href="synpatic-plasticity.html#cb20-68" tabindex="-1"></a>    ax1.plot(t, v1_record[<span class="dv">0</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;v1&#39;</span>)</span>
<span id="cb20-69"><a href="synpatic-plasticity.html#cb20-69" tabindex="-1"></a>    ax2.plot(t, g1_record[<span class="dv">0</span>], <span class="st">&#39;C1&#39;</span>, label<span class="op">=</span><span class="st">&#39;g1&#39;</span>)</span>
<span id="cb20-70"><a href="synpatic-plasticity.html#cb20-70" tabindex="-1"></a>    ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb20-71"><a href="synpatic-plasticity.html#cb20-71" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb20-72"><a href="synpatic-plasticity.html#cb20-72" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb20-73"><a href="synpatic-plasticity.html#cb20-73" tabindex="-1"></a></span>
<span id="cb20-74"><a href="synpatic-plasticity.html#cb20-74" tabindex="-1"></a>    ax1 <span class="op">=</span> ax20</span>
<span id="cb20-75"><a href="synpatic-plasticity.html#cb20-75" tabindex="-1"></a>    ax2 <span class="op">=</span> ax20.twinx()</span>
<span id="cb20-76"><a href="synpatic-plasticity.html#cb20-76" tabindex="-1"></a>    ax1.plot(t, v2_record[<span class="dv">0</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;v2&#39;</span>)</span>
<span id="cb20-77"><a href="synpatic-plasticity.html#cb20-77" tabindex="-1"></a>    ax2.plot(t, g2_record[<span class="dv">0</span>], <span class="st">&#39;C1&#39;</span>, label<span class="op">=</span><span class="st">&#39;g2&#39;</span>)</span>
<span id="cb20-78"><a href="synpatic-plasticity.html#cb20-78" tabindex="-1"></a>    ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb20-79"><a href="synpatic-plasticity.html#cb20-79" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb20-80"><a href="synpatic-plasticity.html#cb20-80" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb20-81"><a href="synpatic-plasticity.html#cb20-81" tabindex="-1"></a></span>
<span id="cb20-82"><a href="synpatic-plasticity.html#cb20-82" tabindex="-1"></a>    ax1 <span class="op">=</span> ax01</span>
<span id="cb20-83"><a href="synpatic-plasticity.html#cb20-83" tabindex="-1"></a>    ax2 <span class="op">=</span> ax01.twinx()</span>
<span id="cb20-84"><a href="synpatic-plasticity.html#cb20-84" tabindex="-1"></a>    ax2.plot(t, g_record[<span class="dv">0</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;external g&#39;</span>)</span>
<span id="cb20-85"><a href="synpatic-plasticity.html#cb20-85" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb20-86"><a href="synpatic-plasticity.html#cb20-86" tabindex="-1"></a>    ax1.set_title(<span class="st">&#39;Trial n&#39;</span>)</span>
<span id="cb20-87"><a href="synpatic-plasticity.html#cb20-87" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb20-88"><a href="synpatic-plasticity.html#cb20-88" tabindex="-1"></a></span>
<span id="cb20-89"><a href="synpatic-plasticity.html#cb20-89" tabindex="-1"></a>    ax1 <span class="op">=</span> ax11</span>
<span id="cb20-90"><a href="synpatic-plasticity.html#cb20-90" tabindex="-1"></a>    ax2 <span class="op">=</span> ax11.twinx()</span>
<span id="cb20-91"><a href="synpatic-plasticity.html#cb20-91" tabindex="-1"></a>    ax1.plot(t, v1_record[<span class="op">-</span><span class="dv">2</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;v1&#39;</span>)</span>
<span id="cb20-92"><a href="synpatic-plasticity.html#cb20-92" tabindex="-1"></a>    ax2.plot(t, g1_record[<span class="op">-</span><span class="dv">2</span>], <span class="st">&#39;C1&#39;</span>, label<span class="op">=</span><span class="st">&#39;g1&#39;</span>)</span>
<span id="cb20-93"><a href="synpatic-plasticity.html#cb20-93" tabindex="-1"></a>    ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb20-94"><a href="synpatic-plasticity.html#cb20-94" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb20-95"><a href="synpatic-plasticity.html#cb20-95" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb20-96"><a href="synpatic-plasticity.html#cb20-96" tabindex="-1"></a></span>
<span id="cb20-97"><a href="synpatic-plasticity.html#cb20-97" tabindex="-1"></a>    ax1 <span class="op">=</span> ax21</span>
<span id="cb20-98"><a href="synpatic-plasticity.html#cb20-98" tabindex="-1"></a>    ax2 <span class="op">=</span> ax21.twinx()</span>
<span id="cb20-99"><a href="synpatic-plasticity.html#cb20-99" tabindex="-1"></a>    ax1.plot(t, v2_record[<span class="op">-</span><span class="dv">2</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;v2&#39;</span>)</span>
<span id="cb20-100"><a href="synpatic-plasticity.html#cb20-100" tabindex="-1"></a>    ax2.plot(t, g2_record[<span class="op">-</span><span class="dv">2</span>], <span class="st">&#39;C1&#39;</span>, label<span class="op">=</span><span class="st">&#39;g2&#39;</span>)</span>
<span id="cb20-101"><a href="synpatic-plasticity.html#cb20-101" tabindex="-1"></a>    ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb20-102"><a href="synpatic-plasticity.html#cb20-102" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb20-103"><a href="synpatic-plasticity.html#cb20-103" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb20-104"><a href="synpatic-plasticity.html#cb20-104" tabindex="-1"></a></span>
<span id="cb20-105"><a href="synpatic-plasticity.html#cb20-105" tabindex="-1"></a>    ax3.plot(np.arange(<span class="dv">0</span>, n_trials, <span class="dv">1</span>), w_12)</span>
<span id="cb20-106"><a href="synpatic-plasticity.html#cb20-106" tabindex="-1"></a>    ax3.set_xlabel(<span class="st">&#39;Trial&#39;</span>)</span>
<span id="cb20-107"><a href="synpatic-plasticity.html#cb20-107" tabindex="-1"></a>    ax3.set_ylabel(<span class="st">&#39;Synaptic Weight (w)&#39;</span>)</span>
<span id="cb20-108"><a href="synpatic-plasticity.html#cb20-108" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb20-109"><a href="synpatic-plasticity.html#cb20-109" tabindex="-1"></a>    plt.show()</span>
<span id="cb20-110"><a href="synpatic-plasticity.html#cb20-110" tabindex="-1"></a></span>
<span id="cb20-111"><a href="synpatic-plasticity.html#cb20-111" tabindex="-1"></a></span>
<span id="cb20-112"><a href="synpatic-plasticity.html#cb20-112" tabindex="-1"></a><span class="kw">def</span> simulate_network(update_weight_func):</span>
<span id="cb20-113"><a href="synpatic-plasticity.html#cb20-113" tabindex="-1"></a></span>
<span id="cb20-114"><a href="synpatic-plasticity.html#cb20-114" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_trials <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb20-115"><a href="synpatic-plasticity.html#cb20-115" tabindex="-1"></a>        trl <span class="op">=</span> j</span>
<span id="cb20-116"><a href="synpatic-plasticity.html#cb20-116" tabindex="-1"></a></span>
<span id="cb20-117"><a href="synpatic-plasticity.html#cb20-117" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb20-118"><a href="synpatic-plasticity.html#cb20-118" tabindex="-1"></a></span>
<span id="cb20-119"><a href="synpatic-plasticity.html#cb20-119" tabindex="-1"></a>            dt <span class="op">=</span> t[i] <span class="op">-</span> t[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb20-120"><a href="synpatic-plasticity.html#cb20-120" tabindex="-1"></a></span>
<span id="cb20-121"><a href="synpatic-plasticity.html#cb20-121" tabindex="-1"></a>            <span class="co"># external input</span></span>
<span id="cb20-122"><a href="synpatic-plasticity.html#cb20-122" tabindex="-1"></a>            dgdt <span class="op">=</span> (<span class="op">-</span>g[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> psp_amp <span class="op">*</span> spike[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> psp_decay</span>
<span id="cb20-123"><a href="synpatic-plasticity.html#cb20-123" tabindex="-1"></a>            g[i] <span class="op">=</span> g[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dgdt <span class="op">*</span> dt</span>
<span id="cb20-124"><a href="synpatic-plasticity.html#cb20-124" tabindex="-1"></a></span>
<span id="cb20-125"><a href="synpatic-plasticity.html#cb20-125" tabindex="-1"></a>            <span class="co"># neuron 1</span></span>
<span id="cb20-126"><a href="synpatic-plasticity.html#cb20-126" tabindex="-1"></a>            dvdt1 <span class="op">=</span> (k <span class="op">*</span> (v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vr) <span class="op">*</span></span>
<span id="cb20-127"><a href="synpatic-plasticity.html#cb20-127" tabindex="-1"></a>                     (v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vt) <span class="op">-</span> u1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> w_01[trl] <span class="op">*</span> g[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> C</span>
<span id="cb20-128"><a href="synpatic-plasticity.html#cb20-128" tabindex="-1"></a>            dudt1 <span class="op">=</span> a <span class="op">*</span> (b <span class="op">*</span> (v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vr) <span class="op">-</span> u1[i <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb20-129"><a href="synpatic-plasticity.html#cb20-129" tabindex="-1"></a>            dgdt1 <span class="op">=</span> (<span class="op">-</span>g1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> psp_amp <span class="op">*</span> spike1[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> psp_decay</span>
<span id="cb20-130"><a href="synpatic-plasticity.html#cb20-130" tabindex="-1"></a>            v1[i] <span class="op">=</span> v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dvdt1 <span class="op">*</span> dt</span>
<span id="cb20-131"><a href="synpatic-plasticity.html#cb20-131" tabindex="-1"></a>            u1[i] <span class="op">=</span> u1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dudt1 <span class="op">*</span> dt</span>
<span id="cb20-132"><a href="synpatic-plasticity.html#cb20-132" tabindex="-1"></a>            g1[i] <span class="op">=</span> g1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dgdt1 <span class="op">*</span> dt</span>
<span id="cb20-133"><a href="synpatic-plasticity.html#cb20-133" tabindex="-1"></a>            <span class="cf">if</span> v1[i] <span class="op">&gt;=</span> vpeak:</span>
<span id="cb20-134"><a href="synpatic-plasticity.html#cb20-134" tabindex="-1"></a>                v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> vpeak</span>
<span id="cb20-135"><a href="synpatic-plasticity.html#cb20-135" tabindex="-1"></a>                v1[i] <span class="op">=</span> c</span>
<span id="cb20-136"><a href="synpatic-plasticity.html#cb20-136" tabindex="-1"></a>                u1[i] <span class="op">=</span> u1[i] <span class="op">+</span> d</span>
<span id="cb20-137"><a href="synpatic-plasticity.html#cb20-137" tabindex="-1"></a>                spike1[i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb20-138"><a href="synpatic-plasticity.html#cb20-138" tabindex="-1"></a></span>
<span id="cb20-139"><a href="synpatic-plasticity.html#cb20-139" tabindex="-1"></a>            <span class="co"># neuron 2</span></span>
<span id="cb20-140"><a href="synpatic-plasticity.html#cb20-140" tabindex="-1"></a>            dvdt2 <span class="op">=</span> (k <span class="op">*</span> (v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vr) <span class="op">*</span></span>
<span id="cb20-141"><a href="synpatic-plasticity.html#cb20-141" tabindex="-1"></a>                     (v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vt) <span class="op">-</span> u2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> w_12[trl] <span class="op">*</span> g1[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> C</span>
<span id="cb20-142"><a href="synpatic-plasticity.html#cb20-142" tabindex="-1"></a>            dudt2 <span class="op">=</span> a <span class="op">*</span> (b <span class="op">*</span> (v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vr) <span class="op">-</span> u2[i <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb20-143"><a href="synpatic-plasticity.html#cb20-143" tabindex="-1"></a>            dgdt2 <span class="op">=</span> (<span class="op">-</span>g2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> psp_amp <span class="op">*</span> spike2[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> psp_decay</span>
<span id="cb20-144"><a href="synpatic-plasticity.html#cb20-144" tabindex="-1"></a>            v2[i] <span class="op">=</span> v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dvdt2 <span class="op">*</span> dt</span>
<span id="cb20-145"><a href="synpatic-plasticity.html#cb20-145" tabindex="-1"></a>            u2[i] <span class="op">=</span> u2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dudt2 <span class="op">*</span> dt</span>
<span id="cb20-146"><a href="synpatic-plasticity.html#cb20-146" tabindex="-1"></a>            g2[i] <span class="op">=</span> g2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dgdt2 <span class="op">*</span> dt</span>
<span id="cb20-147"><a href="synpatic-plasticity.html#cb20-147" tabindex="-1"></a>            <span class="cf">if</span> v2[i] <span class="op">&gt;=</span> vpeak:</span>
<span id="cb20-148"><a href="synpatic-plasticity.html#cb20-148" tabindex="-1"></a>                v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> vpeak</span>
<span id="cb20-149"><a href="synpatic-plasticity.html#cb20-149" tabindex="-1"></a>                v2[i] <span class="op">=</span> c</span>
<span id="cb20-150"><a href="synpatic-plasticity.html#cb20-150" tabindex="-1"></a>                u2[i] <span class="op">=</span> u2[i] <span class="op">+</span> d</span>
<span id="cb20-151"><a href="synpatic-plasticity.html#cb20-151" tabindex="-1"></a>                spike2[i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb20-152"><a href="synpatic-plasticity.html#cb20-152" tabindex="-1"></a></span>
<span id="cb20-153"><a href="synpatic-plasticity.html#cb20-153" tabindex="-1"></a>        <span class="co"># update synaptic weights</span></span>
<span id="cb20-154"><a href="synpatic-plasticity.html#cb20-154" tabindex="-1"></a>        delta_w <span class="op">=</span> update_weight_func()</span>
<span id="cb20-155"><a href="synpatic-plasticity.html#cb20-155" tabindex="-1"></a>        w_12[trl <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> w_12[trl] <span class="op">+</span> delta_w</span>
<span id="cb20-156"><a href="synpatic-plasticity.html#cb20-156" tabindex="-1"></a></span>
<span id="cb20-157"><a href="synpatic-plasticity.html#cb20-157" tabindex="-1"></a>        <span class="co"># store trial info</span></span>
<span id="cb20-158"><a href="synpatic-plasticity.html#cb20-158" tabindex="-1"></a>        g_record[trl, :] <span class="op">=</span> g</span>
<span id="cb20-159"><a href="synpatic-plasticity.html#cb20-159" tabindex="-1"></a>        v1_record[trl, :] <span class="op">=</span> v1</span>
<span id="cb20-160"><a href="synpatic-plasticity.html#cb20-160" tabindex="-1"></a>        g1_record[trl, :] <span class="op">=</span> g1</span>
<span id="cb20-161"><a href="synpatic-plasticity.html#cb20-161" tabindex="-1"></a>        v2_record[trl, :] <span class="op">=</span> v2</span>
<span id="cb20-162"><a href="synpatic-plasticity.html#cb20-162" tabindex="-1"></a>        g2_record[trl, :] <span class="op">=</span> g2</span>
<span id="cb20-163"><a href="synpatic-plasticity.html#cb20-163" tabindex="-1"></a></span>
<span id="cb20-164"><a href="synpatic-plasticity.html#cb20-164" tabindex="-1"></a>    plot_results()</span>
<span id="cb20-165"><a href="synpatic-plasticity.html#cb20-165" tabindex="-1"></a>    </span>
<span id="cb20-166"><a href="synpatic-plasticity.html#cb20-166" tabindex="-1"></a></span>
<span id="cb20-167"><a href="synpatic-plasticity.html#cb20-167" tabindex="-1"></a>n_trials <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb20-168"><a href="synpatic-plasticity.html#cb20-168" tabindex="-1"></a>trl <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-169"><a href="synpatic-plasticity.html#cb20-169" tabindex="-1"></a></span>
<span id="cb20-170"><a href="synpatic-plasticity.html#cb20-170" tabindex="-1"></a>tau <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb20-171"><a href="synpatic-plasticity.html#cb20-171" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb20-172"><a href="synpatic-plasticity.html#cb20-172" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, tau)</span>
<span id="cb20-173"><a href="synpatic-plasticity.html#cb20-173" tabindex="-1"></a>n <span class="op">=</span> t.shape[<span class="dv">0</span>]</span>
<span id="cb20-174"><a href="synpatic-plasticity.html#cb20-174" tabindex="-1"></a></span>
<span id="cb20-175"><a href="synpatic-plasticity.html#cb20-175" tabindex="-1"></a>C <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb20-176"><a href="synpatic-plasticity.html#cb20-176" tabindex="-1"></a>vr <span class="op">=</span> <span class="op">-</span><span class="dv">80</span></span>
<span id="cb20-177"><a href="synpatic-plasticity.html#cb20-177" tabindex="-1"></a>vt <span class="op">=</span> <span class="op">-</span><span class="dv">25</span></span>
<span id="cb20-178"><a href="synpatic-plasticity.html#cb20-178" tabindex="-1"></a>vpeak <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb20-179"><a href="synpatic-plasticity.html#cb20-179" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb20-180"><a href="synpatic-plasticity.html#cb20-180" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb20-181"><a href="synpatic-plasticity.html#cb20-181" tabindex="-1"></a>b <span class="op">=</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb20-182"><a href="synpatic-plasticity.html#cb20-182" tabindex="-1"></a>c <span class="op">=</span> <span class="op">-</span><span class="dv">55</span></span>
<span id="cb20-183"><a href="synpatic-plasticity.html#cb20-183" tabindex="-1"></a>d <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb20-184"><a href="synpatic-plasticity.html#cb20-184" tabindex="-1"></a></span>
<span id="cb20-185"><a href="synpatic-plasticity.html#cb20-185" tabindex="-1"></a>psp_amp <span class="op">=</span> <span class="fl">1e5</span></span>
<span id="cb20-186"><a href="synpatic-plasticity.html#cb20-186" tabindex="-1"></a>psp_decay <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb20-187"><a href="synpatic-plasticity.html#cb20-187" tabindex="-1"></a></span>
<span id="cb20-188"><a href="synpatic-plasticity.html#cb20-188" tabindex="-1"></a>g <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-189"><a href="synpatic-plasticity.html#cb20-189" tabindex="-1"></a>spike <span class="op">=</span> np.zeros(n)</span>
<span id="cb20-190"><a href="synpatic-plasticity.html#cb20-190" tabindex="-1"></a>spike[<span class="dv">200</span>:<span class="dv">800</span>:<span class="dv">20</span>] <span class="op">=</span> <span class="dv">1</span></span></code></pre></div>
</div>
<div id="hebbian-learning-1" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Hebbian Learning 1<a href="synpatic-plasticity.html#hebbian-learning-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
w_{ij}(n+1) = w_{ij}(n) + \alpha A_i(n) A_j(n)
\]</span></p>
<ul>
<li><p>Neurons that fire together wire together.</p></li>
<li><p>Simple equation that can only generate LTP. It cannot
generate LTD.</p></li>
<li><p>Weakness is that it predicts all plastic synapses
ultimately grow to infinity. This is because <span class="math inline">\(A_i(n)&gt;0\)</span> and
<span class="math inline">\(A_j(n)&gt;0\)</span>.</p></li>
<li><p>The following <code>Python</code> code implements this learning rule.</p></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="synpatic-plasticity.html#cb21-1" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb21-2"><a href="synpatic-plasticity.html#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="synpatic-plasticity.html#cb21-3" tabindex="-1"></a><span class="kw">def</span> update_weight_1():</span>
<span id="cb21-4"><a href="synpatic-plasticity.html#cb21-4" tabindex="-1"></a>    pre <span class="op">=</span> g1.<span class="bu">sum</span>()</span>
<span id="cb21-5"><a href="synpatic-plasticity.html#cb21-5" tabindex="-1"></a>    post <span class="op">=</span> g2.<span class="bu">sum</span>()</span>
<span id="cb21-6"><a href="synpatic-plasticity.html#cb21-6" tabindex="-1"></a>    delta_w <span class="op">=</span> alpha <span class="op">*</span> pre <span class="op">*</span> post</span>
<span id="cb21-7"><a href="synpatic-plasticity.html#cb21-7" tabindex="-1"></a></span>
<span id="cb21-8"><a href="synpatic-plasticity.html#cb21-8" tabindex="-1"></a>    <span class="cf">return</span> delta_w</span></code></pre></div>
<ul>
<li>We next initialise the needed arrays and simulate the
network using the above learning rule.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="synpatic-plasticity.html#cb22-1" tabindex="-1"></a>array_dict <span class="op">=</span> init_arrays()</span>
<span id="cb22-2"><a href="synpatic-plasticity.html#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="synpatic-plasticity.html#cb22-3" tabindex="-1"></a>v1 <span class="op">=</span> array_dict[<span class="st">&#39;v1&#39;</span>]</span>
<span id="cb22-4"><a href="synpatic-plasticity.html#cb22-4" tabindex="-1"></a>u1 <span class="op">=</span> array_dict[<span class="st">&#39;u1&#39;</span>]</span>
<span id="cb22-5"><a href="synpatic-plasticity.html#cb22-5" tabindex="-1"></a>g1 <span class="op">=</span> array_dict[<span class="st">&#39;g1&#39;</span>]</span>
<span id="cb22-6"><a href="synpatic-plasticity.html#cb22-6" tabindex="-1"></a>spike1 <span class="op">=</span> array_dict[<span class="st">&#39;spike1&#39;</span>]</span>
<span id="cb22-7"><a href="synpatic-plasticity.html#cb22-7" tabindex="-1"></a>v2 <span class="op">=</span> array_dict[<span class="st">&#39;v2&#39;</span>]</span>
<span id="cb22-8"><a href="synpatic-plasticity.html#cb22-8" tabindex="-1"></a>u2 <span class="op">=</span> array_dict[<span class="st">&#39;u2&#39;</span>]</span>
<span id="cb22-9"><a href="synpatic-plasticity.html#cb22-9" tabindex="-1"></a>g2 <span class="op">=</span> array_dict[<span class="st">&#39;g2&#39;</span>]</span>
<span id="cb22-10"><a href="synpatic-plasticity.html#cb22-10" tabindex="-1"></a>spike2 <span class="op">=</span> array_dict[<span class="st">&#39;spike2&#39;</span>]</span>
<span id="cb22-11"><a href="synpatic-plasticity.html#cb22-11" tabindex="-1"></a>w_01 <span class="op">=</span> array_dict[<span class="st">&#39;w_01&#39;</span>]</span>
<span id="cb22-12"><a href="synpatic-plasticity.html#cb22-12" tabindex="-1"></a>w_12 <span class="op">=</span> array_dict[<span class="st">&#39;w_12&#39;</span>]</span>
<span id="cb22-13"><a href="synpatic-plasticity.html#cb22-13" tabindex="-1"></a>g_record <span class="op">=</span> array_dict[<span class="st">&#39;g_record&#39;</span>]</span>
<span id="cb22-14"><a href="synpatic-plasticity.html#cb22-14" tabindex="-1"></a>v1_record <span class="op">=</span> array_dict[<span class="st">&#39;v1_record&#39;</span>]</span>
<span id="cb22-15"><a href="synpatic-plasticity.html#cb22-15" tabindex="-1"></a>g1_record <span class="op">=</span> array_dict[<span class="st">&#39;g1_record&#39;</span>]</span>
<span id="cb22-16"><a href="synpatic-plasticity.html#cb22-16" tabindex="-1"></a>v2_record <span class="op">=</span> array_dict[<span class="st">&#39;v2_record&#39;</span>]</span>
<span id="cb22-17"><a href="synpatic-plasticity.html#cb22-17" tabindex="-1"></a>g2_record <span class="op">=</span> array_dict[<span class="st">&#39;g2_record&#39;</span>]</span>
<span id="cb22-18"><a href="synpatic-plasticity.html#cb22-18" tabindex="-1"></a></span>
<span id="cb22-19"><a href="synpatic-plasticity.html#cb22-19" tabindex="-1"></a>update_weight_func <span class="op">=</span> update_weight_1</span>
<span id="cb22-20"><a href="synpatic-plasticity.html#cb22-20" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb22-21"><a href="synpatic-plasticity.html#cb22-21" tabindex="-1"></a>simulate_network(update_weight_func)</span></code></pre></div>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-28-1.png" width="768" /></p>
</div>
<div id="hebbian-learning-2" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Hebbian Learning 2<a href="synpatic-plasticity.html#hebbian-learning-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
\begin{align}
w_{ij}(n+1) &amp;= w_{ij}(n) \\
&amp; + \alpha H[A_j(n) - \theta] A_i(n)\\
&amp; - \beta  H[\theta - A_j(n)] A_i(n)
\end{align}
\]</span></p>
<ul>
<li><p>Simple augmentation of the Hebbian learning rule above.</p></li>
<li><p>Assumes an activity threshold <span class="math inline">\(\theta\)</span> that can cause
either LTP or LTD to occur.</p></li>
<li><p><span class="math inline">\(H[z(x)]\)</span> is the Heaviside function and is <span class="math inline">\(0\)</span> if <span class="math inline">\(z(x)&lt;0\)</span>
and is <span class="math inline">\(z(x)\)</span> otherwise.</p></li>
<li><p>Thus, this equation says that if the activation in the
postsynapctic neuron is strong enough, then LTP will occur.
If there is only weak activation (i.e., less than <span class="math inline">\(\theta\)</span>)
then LTD will occur.</p></li>
<li><p>This is an improvement because it is still quite simple
and has both LTP and LTD. However, it can still grow to
infinity or – even more strangely – negative infinity.</p></li>
<li><p>The following <code>Python</code> code implements this learning rule.</p></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="synpatic-plasticity.html#cb23-1" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb23-2"><a href="synpatic-plasticity.html#cb23-2" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb23-3"><a href="synpatic-plasticity.html#cb23-3" tabindex="-1"></a>theta <span class="op">=</span> <span class="fl">2e6</span> <span class="co"># make this small for LTP or large for LTD</span></span>
<span id="cb23-4"><a href="synpatic-plasticity.html#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="synpatic-plasticity.html#cb23-5" tabindex="-1"></a><span class="kw">def</span> update_weight_2():</span>
<span id="cb23-6"><a href="synpatic-plasticity.html#cb23-6" tabindex="-1"></a>    pre <span class="op">=</span> g1.<span class="bu">sum</span>()</span>
<span id="cb23-7"><a href="synpatic-plasticity.html#cb23-7" tabindex="-1"></a>    post_ltp <span class="op">=</span> np.clip(g2.<span class="bu">sum</span>() <span class="op">-</span> theta, <span class="dv">0</span>, <span class="va">None</span>)</span>
<span id="cb23-8"><a href="synpatic-plasticity.html#cb23-8" tabindex="-1"></a>    post_ltd <span class="op">=</span> np.clip(theta <span class="op">-</span> g2.<span class="bu">sum</span>(), <span class="dv">0</span>, <span class="va">None</span>)</span>
<span id="cb23-9"><a href="synpatic-plasticity.html#cb23-9" tabindex="-1"></a>    delta_w <span class="op">=</span> alpha <span class="op">*</span> pre <span class="op">*</span> post_ltp <span class="op">-</span> beta <span class="op">*</span> pre <span class="op">*</span> post_ltd</span>
<span id="cb23-10"><a href="synpatic-plasticity.html#cb23-10" tabindex="-1"></a></span>
<span id="cb23-11"><a href="synpatic-plasticity.html#cb23-11" tabindex="-1"></a>    <span class="cf">return</span> delta_w</span></code></pre></div>
<ul>
<li>We next initialise the needed arrays and simulate the
network using the above learning rule.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="synpatic-plasticity.html#cb24-1" tabindex="-1"></a>array_dict <span class="op">=</span> init_arrays()</span>
<span id="cb24-2"><a href="synpatic-plasticity.html#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="synpatic-plasticity.html#cb24-3" tabindex="-1"></a>v1 <span class="op">=</span> array_dict[<span class="st">&#39;v1&#39;</span>]</span>
<span id="cb24-4"><a href="synpatic-plasticity.html#cb24-4" tabindex="-1"></a>u1 <span class="op">=</span> array_dict[<span class="st">&#39;u1&#39;</span>]</span>
<span id="cb24-5"><a href="synpatic-plasticity.html#cb24-5" tabindex="-1"></a>g1 <span class="op">=</span> array_dict[<span class="st">&#39;g1&#39;</span>]</span>
<span id="cb24-6"><a href="synpatic-plasticity.html#cb24-6" tabindex="-1"></a>spike1 <span class="op">=</span> array_dict[<span class="st">&#39;spike1&#39;</span>]</span>
<span id="cb24-7"><a href="synpatic-plasticity.html#cb24-7" tabindex="-1"></a>v2 <span class="op">=</span> array_dict[<span class="st">&#39;v2&#39;</span>]</span>
<span id="cb24-8"><a href="synpatic-plasticity.html#cb24-8" tabindex="-1"></a>u2 <span class="op">=</span> array_dict[<span class="st">&#39;u2&#39;</span>]</span>
<span id="cb24-9"><a href="synpatic-plasticity.html#cb24-9" tabindex="-1"></a>g2 <span class="op">=</span> array_dict[<span class="st">&#39;g2&#39;</span>]</span>
<span id="cb24-10"><a href="synpatic-plasticity.html#cb24-10" tabindex="-1"></a>spike2 <span class="op">=</span> array_dict[<span class="st">&#39;spike2&#39;</span>]</span>
<span id="cb24-11"><a href="synpatic-plasticity.html#cb24-11" tabindex="-1"></a>w_01 <span class="op">=</span> array_dict[<span class="st">&#39;w_01&#39;</span>]</span>
<span id="cb24-12"><a href="synpatic-plasticity.html#cb24-12" tabindex="-1"></a>w_12 <span class="op">=</span> array_dict[<span class="st">&#39;w_12&#39;</span>]</span>
<span id="cb24-13"><a href="synpatic-plasticity.html#cb24-13" tabindex="-1"></a>g_record <span class="op">=</span> array_dict[<span class="st">&#39;g_record&#39;</span>]</span>
<span id="cb24-14"><a href="synpatic-plasticity.html#cb24-14" tabindex="-1"></a>v1_record <span class="op">=</span> array_dict[<span class="st">&#39;v1_record&#39;</span>]</span>
<span id="cb24-15"><a href="synpatic-plasticity.html#cb24-15" tabindex="-1"></a>g1_record <span class="op">=</span> array_dict[<span class="st">&#39;g1_record&#39;</span>]</span>
<span id="cb24-16"><a href="synpatic-plasticity.html#cb24-16" tabindex="-1"></a>v2_record <span class="op">=</span> array_dict[<span class="st">&#39;v2_record&#39;</span>]</span>
<span id="cb24-17"><a href="synpatic-plasticity.html#cb24-17" tabindex="-1"></a>g2_record <span class="op">=</span> array_dict[<span class="st">&#39;g2_record&#39;</span>]</span>
<span id="cb24-18"><a href="synpatic-plasticity.html#cb24-18" tabindex="-1"></a></span>
<span id="cb24-19"><a href="synpatic-plasticity.html#cb24-19" tabindex="-1"></a>update_weight_func <span class="op">=</span> update_weight_2</span>
<span id="cb24-20"><a href="synpatic-plasticity.html#cb24-20" tabindex="-1"></a>simulate_network(update_weight_func)</span></code></pre></div>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-30-3.png" width="768" /></p>
</div>
<div id="hebbian-learning-3" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Hebbian Learning 3<a href="synpatic-plasticity.html#hebbian-learning-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
\begin{align}
w_{ij}(n+1) &amp;= w_{ij}(n) \\
&amp;+ \alpha H[A_j(n)-\theta] [A_i(n)] [1 - w_{ij}(n)] \\
&amp;- \beta  H[\theta-A_j(n)] [A_i(n)] [w_{ij}(n)]
\end{align}
\]</span></p>
<ul>
<li><p>Add a rate-limiting terms to prevent growth to <span class="math inline">\(\pm\)</span> infinity</p></li>
<li><p>The rest is the same as above.</p></li>
<li><p>The following <code>Python</code> code implements this learning rule.</p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="synpatic-plasticity.html#cb25-1" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb25-2"><a href="synpatic-plasticity.html#cb25-2" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb25-3"><a href="synpatic-plasticity.html#cb25-3" tabindex="-1"></a>theta <span class="op">=</span> <span class="fl">2e6</span></span>
<span id="cb25-4"><a href="synpatic-plasticity.html#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="synpatic-plasticity.html#cb25-5" tabindex="-1"></a><span class="kw">def</span> update_weight_3():</span>
<span id="cb25-6"><a href="synpatic-plasticity.html#cb25-6" tabindex="-1"></a>    pre <span class="op">=</span> g1.<span class="bu">sum</span>()</span>
<span id="cb25-7"><a href="synpatic-plasticity.html#cb25-7" tabindex="-1"></a>    post_ltp <span class="op">=</span> np.clip(g2.<span class="bu">sum</span>() <span class="op">-</span> theta, <span class="dv">0</span>, <span class="va">None</span>) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> w_12[trl])</span>
<span id="cb25-8"><a href="synpatic-plasticity.html#cb25-8" tabindex="-1"></a>    post_ltd <span class="op">=</span> np.clip(theta <span class="op">-</span> g2.<span class="bu">sum</span>(), <span class="dv">0</span>, <span class="va">None</span>) <span class="op">*</span> w_12[trl]</span>
<span id="cb25-9"><a href="synpatic-plasticity.html#cb25-9" tabindex="-1"></a>    delta_w <span class="op">=</span> alpha <span class="op">*</span> pre <span class="op">*</span> post_ltp <span class="op">-</span> beta <span class="op">*</span> pre <span class="op">*</span> post_ltd</span>
<span id="cb25-10"><a href="synpatic-plasticity.html#cb25-10" tabindex="-1"></a></span>
<span id="cb25-11"><a href="synpatic-plasticity.html#cb25-11" tabindex="-1"></a>    <span class="cf">return</span> delta_w</span></code></pre></div>
<ul>
<li>We next initialise the needed arrays and simulate the
network using the above learning rule.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="synpatic-plasticity.html#cb26-1" tabindex="-1"></a>array_dict <span class="op">=</span> init_arrays()</span>
<span id="cb26-2"><a href="synpatic-plasticity.html#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="synpatic-plasticity.html#cb26-3" tabindex="-1"></a>v1 <span class="op">=</span> array_dict[<span class="st">&#39;v1&#39;</span>]</span>
<span id="cb26-4"><a href="synpatic-plasticity.html#cb26-4" tabindex="-1"></a>u1 <span class="op">=</span> array_dict[<span class="st">&#39;u1&#39;</span>]</span>
<span id="cb26-5"><a href="synpatic-plasticity.html#cb26-5" tabindex="-1"></a>g1 <span class="op">=</span> array_dict[<span class="st">&#39;g1&#39;</span>]</span>
<span id="cb26-6"><a href="synpatic-plasticity.html#cb26-6" tabindex="-1"></a>spike1 <span class="op">=</span> array_dict[<span class="st">&#39;spike1&#39;</span>]</span>
<span id="cb26-7"><a href="synpatic-plasticity.html#cb26-7" tabindex="-1"></a>v2 <span class="op">=</span> array_dict[<span class="st">&#39;v2&#39;</span>]</span>
<span id="cb26-8"><a href="synpatic-plasticity.html#cb26-8" tabindex="-1"></a>u2 <span class="op">=</span> array_dict[<span class="st">&#39;u2&#39;</span>]</span>
<span id="cb26-9"><a href="synpatic-plasticity.html#cb26-9" tabindex="-1"></a>g2 <span class="op">=</span> array_dict[<span class="st">&#39;g2&#39;</span>]</span>
<span id="cb26-10"><a href="synpatic-plasticity.html#cb26-10" tabindex="-1"></a>spike2 <span class="op">=</span> array_dict[<span class="st">&#39;spike2&#39;</span>]</span>
<span id="cb26-11"><a href="synpatic-plasticity.html#cb26-11" tabindex="-1"></a>w_01 <span class="op">=</span> array_dict[<span class="st">&#39;w_01&#39;</span>]</span>
<span id="cb26-12"><a href="synpatic-plasticity.html#cb26-12" tabindex="-1"></a>w_12 <span class="op">=</span> array_dict[<span class="st">&#39;w_12&#39;</span>]</span>
<span id="cb26-13"><a href="synpatic-plasticity.html#cb26-13" tabindex="-1"></a>g_record <span class="op">=</span> array_dict[<span class="st">&#39;g_record&#39;</span>]</span>
<span id="cb26-14"><a href="synpatic-plasticity.html#cb26-14" tabindex="-1"></a>v1_record <span class="op">=</span> array_dict[<span class="st">&#39;v1_record&#39;</span>]</span>
<span id="cb26-15"><a href="synpatic-plasticity.html#cb26-15" tabindex="-1"></a>g1_record <span class="op">=</span> array_dict[<span class="st">&#39;g1_record&#39;</span>]</span>
<span id="cb26-16"><a href="synpatic-plasticity.html#cb26-16" tabindex="-1"></a>v2_record <span class="op">=</span> array_dict[<span class="st">&#39;v2_record&#39;</span>]</span>
<span id="cb26-17"><a href="synpatic-plasticity.html#cb26-17" tabindex="-1"></a>g2_record <span class="op">=</span> array_dict[<span class="st">&#39;g2_record&#39;</span>]</span>
<span id="cb26-18"><a href="synpatic-plasticity.html#cb26-18" tabindex="-1"></a></span>
<span id="cb26-19"><a href="synpatic-plasticity.html#cb26-19" tabindex="-1"></a>update_weight_func <span class="op">=</span> update_weight_3</span>
<span id="cb26-20"><a href="synpatic-plasticity.html#cb26-20" tabindex="-1"></a>simulate_network(update_weight_func)</span></code></pre></div>
<pre><code>## &lt;string&gt;:2: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.</code></pre>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-32-5.png" width="768" /></p>
</div>
<div id="hebbian-stdp" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Hebbian STDP<a href="synpatic-plasticity.html#hebbian-stdp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
\begin{align}
w_{ij}(n+1) &amp;= w_{ij}(n) \\
&amp;+ \alpha H[A_j(n)-\theta] [A_i(n)] [1 - w_{ij}(n)] \Delta \\
&amp;- \beta  H[\theta-A_j(n)] [A_i(n)] [w_{ij}(n)]
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\Delta =
\begin{cases}
e^{-(T_{\text{post}} - T_{\text{pre}}) / \tau_+} &amp;\text{ if } T_{\text{post}} &gt; T_{\text{pre}} \\
-e^{ (T_{\text{post}} - T_{\text{pre}}) / \tau_-} &amp;\text{ if }  T_{\text{post}} &lt; T_{\text{pre}} \\
\end{cases}
\end{align}
\]</span></p>
<ul>
<li><p>Synaptic plasticity depends on the timing of spikes as
well as the overall magnitude of neural activations between
pre and postsynatpic neurons.</p></li>
<li><p>LTP is caused if the presynaptic neuron fires before the
postsynaptic neuron. LTD is caused in the inverse situation.</p></li>
<li><p>The magnitude of LTP / LTD falls off exponentially as the
time between pre and postsynaptic spikes gets larger.</p></li>
<li><p>The following <code>Python</code> code implements this learning rule.</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="synpatic-plasticity.html#cb28-1" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb28-2"><a href="synpatic-plasticity.html#cb28-2" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb28-3"><a href="synpatic-plasticity.html#cb28-3" tabindex="-1"></a>theta <span class="op">=</span> <span class="fl">2e6</span></span>
<span id="cb28-4"><a href="synpatic-plasticity.html#cb28-4" tabindex="-1"></a>tau_pos <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb28-5"><a href="synpatic-plasticity.html#cb28-5" tabindex="-1"></a>tau_neg <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb28-6"><a href="synpatic-plasticity.html#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="synpatic-plasticity.html#cb28-7" tabindex="-1"></a><span class="kw">def</span> update_weight_stdp():</span>
<span id="cb28-8"><a href="synpatic-plasticity.html#cb28-8" tabindex="-1"></a>    delta_stdp <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-9"><a href="synpatic-plasticity.html#cb28-9" tabindex="-1"></a>    n_pre_spikes <span class="op">=</span> spike1.<span class="bu">sum</span>().astype(<span class="bu">int</span>)</span>
<span id="cb28-10"><a href="synpatic-plasticity.html#cb28-10" tabindex="-1"></a>    n_post_spikes <span class="op">=</span> spike2.<span class="bu">sum</span>().astype(<span class="bu">int</span>)</span>
<span id="cb28-11"><a href="synpatic-plasticity.html#cb28-11" tabindex="-1"></a>    pre_spike_times <span class="op">=</span> t[spike1<span class="op">==</span><span class="dv">1</span>]</span>
<span id="cb28-12"><a href="synpatic-plasticity.html#cb28-12" tabindex="-1"></a>    post_spike_times <span class="op">=</span> t[spike2<span class="op">==</span><span class="dv">1</span>]</span>
<span id="cb28-13"><a href="synpatic-plasticity.html#cb28-13" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_pre_spikes):</span>
<span id="cb28-14"><a href="synpatic-plasticity.html#cb28-14" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_post_spikes):</span>
<span id="cb28-15"><a href="synpatic-plasticity.html#cb28-15" tabindex="-1"></a>            T_pre <span class="op">=</span> pre_spike_times[i]</span>
<span id="cb28-16"><a href="synpatic-plasticity.html#cb28-16" tabindex="-1"></a>            T_post <span class="op">=</span> post_spike_times[j]</span>
<span id="cb28-17"><a href="synpatic-plasticity.html#cb28-17" tabindex="-1"></a>            delta_T <span class="op">=</span> T_post <span class="op">-</span> T_pre</span>
<span id="cb28-18"><a href="synpatic-plasticity.html#cb28-18" tabindex="-1"></a>            <span class="cf">if</span> delta_T <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb28-19"><a href="synpatic-plasticity.html#cb28-19" tabindex="-1"></a>                delta_stdp <span class="op">+=</span> np.exp(<span class="op">-</span>(delta_T)<span class="op">/</span>tau_pos)</span>
<span id="cb28-20"><a href="synpatic-plasticity.html#cb28-20" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb28-21"><a href="synpatic-plasticity.html#cb28-21" tabindex="-1"></a>                delta_stdp <span class="op">+=</span> np.exp((delta_T)<span class="op">/</span>tau_neg)</span>
<span id="cb28-22"><a href="synpatic-plasticity.html#cb28-22" tabindex="-1"></a></span>
<span id="cb28-23"><a href="synpatic-plasticity.html#cb28-23" tabindex="-1"></a>    pre <span class="op">=</span> g1.<span class="bu">sum</span>()</span>
<span id="cb28-24"><a href="synpatic-plasticity.html#cb28-24" tabindex="-1"></a>    post_above_thresh <span class="op">=</span> np.clip(g2.<span class="bu">sum</span>() <span class="op">-</span> theta, <span class="dv">0</span>, <span class="va">None</span>) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> w_12[trl]) <span class="op">*</span> delta_stdp</span>
<span id="cb28-25"><a href="synpatic-plasticity.html#cb28-25" tabindex="-1"></a>    post_below_thresh <span class="op">=</span> np.clip(theta <span class="op">-</span> g2.<span class="bu">sum</span>(), <span class="dv">0</span>, <span class="va">None</span>) <span class="op">*</span> w_12[trl]</span>
<span id="cb28-26"><a href="synpatic-plasticity.html#cb28-26" tabindex="-1"></a>    delta_w <span class="op">=</span> alpha <span class="op">*</span> pre <span class="op">*</span> post_above_thresh <span class="op">-</span> beta <span class="op">*</span> pre <span class="op">*</span> post_below_thresh</span>
<span id="cb28-27"><a href="synpatic-plasticity.html#cb28-27" tabindex="-1"></a></span>
<span id="cb28-28"><a href="synpatic-plasticity.html#cb28-28" tabindex="-1"></a>    <span class="cf">return</span> delta_w</span></code></pre></div>
<ul>
<li>We next initialise the needed arrays and simulate the
network using the above learning rule.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="synpatic-plasticity.html#cb29-1" tabindex="-1"></a>array_dict <span class="op">=</span> init_arrays()</span>
<span id="cb29-2"><a href="synpatic-plasticity.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="synpatic-plasticity.html#cb29-3" tabindex="-1"></a>v1 <span class="op">=</span> array_dict[<span class="st">&#39;v1&#39;</span>]</span>
<span id="cb29-4"><a href="synpatic-plasticity.html#cb29-4" tabindex="-1"></a>u1 <span class="op">=</span> array_dict[<span class="st">&#39;u1&#39;</span>]</span>
<span id="cb29-5"><a href="synpatic-plasticity.html#cb29-5" tabindex="-1"></a>g1 <span class="op">=</span> array_dict[<span class="st">&#39;g1&#39;</span>]</span>
<span id="cb29-6"><a href="synpatic-plasticity.html#cb29-6" tabindex="-1"></a>spike1 <span class="op">=</span> array_dict[<span class="st">&#39;spike1&#39;</span>]</span>
<span id="cb29-7"><a href="synpatic-plasticity.html#cb29-7" tabindex="-1"></a>v2 <span class="op">=</span> array_dict[<span class="st">&#39;v2&#39;</span>]</span>
<span id="cb29-8"><a href="synpatic-plasticity.html#cb29-8" tabindex="-1"></a>u2 <span class="op">=</span> array_dict[<span class="st">&#39;u2&#39;</span>]</span>
<span id="cb29-9"><a href="synpatic-plasticity.html#cb29-9" tabindex="-1"></a>g2 <span class="op">=</span> array_dict[<span class="st">&#39;g2&#39;</span>]</span>
<span id="cb29-10"><a href="synpatic-plasticity.html#cb29-10" tabindex="-1"></a>spike2 <span class="op">=</span> array_dict[<span class="st">&#39;spike2&#39;</span>]</span>
<span id="cb29-11"><a href="synpatic-plasticity.html#cb29-11" tabindex="-1"></a>w_01 <span class="op">=</span> array_dict[<span class="st">&#39;w_01&#39;</span>]</span>
<span id="cb29-12"><a href="synpatic-plasticity.html#cb29-12" tabindex="-1"></a>w_12 <span class="op">=</span> array_dict[<span class="st">&#39;w_12&#39;</span>]</span>
<span id="cb29-13"><a href="synpatic-plasticity.html#cb29-13" tabindex="-1"></a>g_record <span class="op">=</span> array_dict[<span class="st">&#39;g_record&#39;</span>]</span>
<span id="cb29-14"><a href="synpatic-plasticity.html#cb29-14" tabindex="-1"></a>v1_record <span class="op">=</span> array_dict[<span class="st">&#39;v1_record&#39;</span>]</span>
<span id="cb29-15"><a href="synpatic-plasticity.html#cb29-15" tabindex="-1"></a>g1_record <span class="op">=</span> array_dict[<span class="st">&#39;g1_record&#39;</span>]</span>
<span id="cb29-16"><a href="synpatic-plasticity.html#cb29-16" tabindex="-1"></a>v2_record <span class="op">=</span> array_dict[<span class="st">&#39;v2_record&#39;</span>]</span>
<span id="cb29-17"><a href="synpatic-plasticity.html#cb29-17" tabindex="-1"></a>g2_record <span class="op">=</span> array_dict[<span class="st">&#39;g2_record&#39;</span>]</span>
<span id="cb29-18"><a href="synpatic-plasticity.html#cb29-18" tabindex="-1"></a></span>
<span id="cb29-19"><a href="synpatic-plasticity.html#cb29-19" tabindex="-1"></a>update_weight_func <span class="op">=</span> update_weight_stdp</span>
<span id="cb29-20"><a href="synpatic-plasticity.html#cb29-20" tabindex="-1"></a>simulate_network(update_weight_func)</span></code></pre></div>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-34-7.png" width="768" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="neurotransmitter-release.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reinforcement-learning.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"depth": 2
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
