<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Example 1 | Introduction to Computational Neuroscience</title>
  <meta name="description" content="12 Example 1 | Introduction to Computational Neuroscience" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Example 1 | Introduction to Computational Neuroscience" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Example 1 | Introduction to Computational Neuroscience" />
  
  
  

<meta name="author" content="Matthew J. Crossley" />


<meta name="date" content="2024-02-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reinforcement-learning-rule.html"/>
<link rel="next" href="example-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the book</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html"><i class="fa fa-check"></i><b>2</b> Introduction to the book</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#what-is-computational-neuroscience"><i class="fa fa-check"></i><b>2.1</b> What is computational neuroscience?</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#marrs-levels"><i class="fa fa-check"></i><b>2.2</b> Marr’s levels</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#why-computers"><i class="fa fa-check"></i><b>2.3</b> Why computers?</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#what-is-the-real-value-gained"><i class="fa fa-check"></i><b>2.4</b> What is the real value gained?</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#why-python"><i class="fa fa-check"></i><b>2.5</b> Why Python</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#getting-started-with-python"><i class="fa fa-check"></i><b>2.6</b> Getting started with Python</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-the-book-1.html"><a href="introduction-to-the-book-1.html#learning-python"><i class="fa fa-check"></i><b>2.7</b> Learning Python</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="numpy-and-matplotlib.html"><a href="numpy-and-matplotlib.html"><i class="fa fa-check"></i><b>3</b> Numpy and Matplotlib</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numpy-and-matplotlib.html"><a href="numpy-and-matplotlib.html#learning-python-1"><i class="fa fa-check"></i><b>3.1</b> Learning Python</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intro-to-calculus.html"><a href="intro-to-calculus.html"><i class="fa fa-check"></i><b>4</b> Intro to calculus</a></li>
<li class="chapter" data-level="5" data-path="intro-to-dynamical-systems.html"><a href="intro-to-dynamical-systems.html"><i class="fa fa-check"></i><b>5</b> Intro to dynamical systems</a>
<ul>
<li class="chapter" data-level="5.1" data-path="intro-to-dynamical-systems.html"><a href="intro-to-dynamical-systems.html#differential-equations"><i class="fa fa-check"></i><b>5.1</b> Differential equations</a></li>
<li class="chapter" data-level="5.2" data-path="intro-to-dynamical-systems.html"><a href="intro-to-dynamical-systems.html#eulers-method"><i class="fa fa-check"></i><b>5.2</b> Euler’s method</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html"><i class="fa fa-check"></i><b>6</b> Simple neuron models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html#review-of-hh"><i class="fa fa-check"></i><b>6.1</b> Review of HH</a></li>
<li class="chapter" data-level="6.2" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html#leaky-integrate-and-fire"><i class="fa fa-check"></i><b>6.2</b> Leaky integrate and fire</a></li>
<li class="chapter" data-level="6.3" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html#quadratic-integrate-and-fire"><i class="fa fa-check"></i><b>6.3</b> Quadratic integrate and fire</a></li>
<li class="chapter" data-level="6.4" data-path="simple-neuron-models.html"><a href="simple-neuron-models.html#izhikevich-neuron"><i class="fa fa-check"></i><b>6.4</b> Izhikevich Neuron</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html"><i class="fa fa-check"></i><b>7</b> Hodgkin-Huxley neuron model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_1"><i class="fa fa-check"></i><b>7.1</b> neuron_func_1</a></li>
<li class="chapter" data-level="7.2" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_2"><i class="fa fa-check"></i><b>7.2</b> neuron_func_2</a></li>
<li class="chapter" data-level="7.3" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_3"><i class="fa fa-check"></i><b>7.3</b> neuron_func_3</a></li>
<li class="chapter" data-level="7.4" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_4"><i class="fa fa-check"></i><b>7.4</b> neuron_func_4</a></li>
<li class="chapter" data-level="7.5" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_5"><i class="fa fa-check"></i><b>7.5</b> neuron_func_5</a></li>
<li class="chapter" data-level="7.6" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_6"><i class="fa fa-check"></i><b>7.6</b> neuron_func_6</a></li>
<li class="chapter" data-level="7.7" data-path="hodgkin-huxley-neuron-model.html"><a href="hodgkin-huxley-neuron-model.html#neuron_func_7"><i class="fa fa-check"></i><b>7.7</b> neuron_func_7</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html"><i class="fa fa-check"></i><b>8</b> Neurotransmitter release</a>
<ul>
<li class="chapter" data-level="8.1" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#synaptics-responses"><i class="fa fa-check"></i><b>8.1</b> Synaptics responses</a></li>
<li class="chapter" data-level="8.2" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#spikes-as-a-change-in-conductance"><i class="fa fa-check"></i><b>8.2</b> Spikes as a change in conductance</a></li>
<li class="chapter" data-level="8.3" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#coupling-conductance-to-psp"><i class="fa fa-check"></i><b>8.3</b> Coupling conductance to PSP</a></li>
<li class="chapter" data-level="8.4" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#psps-superimpose"><i class="fa fa-check"></i><b>8.4</b> PSPs superimpose</a></li>
<li class="chapter" data-level="8.5" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#psp-model-in-the-izhikevich-neuron"><i class="fa fa-check"></i><b>8.5</b> PSP model in the Izhikevich neuron</a></li>
<li class="chapter" data-level="8.6" data-path="neurotransmitter-release.html"><a href="neurotransmitter-release.html#chaining-neurons-together"><i class="fa fa-check"></i><b>8.6</b> Chaining neurons together</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html"><i class="fa fa-check"></i><b>9</b> Synpatic Plasticity</a>
<ul>
<li class="chapter" data-level="9.1" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#python-helper-functions"><i class="fa fa-check"></i><b>9.1</b> Python helper functions</a></li>
<li class="chapter" data-level="9.2" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#hebbian-learning-1"><i class="fa fa-check"></i><b>9.2</b> Hebbian Learning 1</a></li>
<li class="chapter" data-level="9.3" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#hebbian-learning-2"><i class="fa fa-check"></i><b>9.3</b> Hebbian Learning 2</a></li>
<li class="chapter" data-level="9.4" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#hebbian-learning-3"><i class="fa fa-check"></i><b>9.4</b> Hebbian Learning 3</a></li>
<li class="chapter" data-level="9.5" data-path="synpatic-plasticity.html"><a href="synpatic-plasticity.html#hebbian-stdp"><i class="fa fa-check"></i><b>9.5</b> Hebbian STDP</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reinforcement-learning.html"><a href="reinforcement-learning.html"><i class="fa fa-check"></i><b>10</b> Reinforcement Learning</a></li>
<li class="chapter" data-level="11" data-path="reinforcement-learning-rule.html"><a href="reinforcement-learning-rule.html"><i class="fa fa-check"></i><b>11</b> Reinforcement learning rule</a></li>
<li class="chapter" data-level="12" data-path="example-1.html"><a href="example-1.html"><i class="fa fa-check"></i><b>12</b> Example 1</a></li>
<li class="chapter" data-level="13" data-path="example-2.html"><a href="example-2.html"><i class="fa fa-check"></i><b>13</b> Example 2</a></li>
<li class="chapter" data-level="14" data-path="example-3.html"><a href="example-3.html"><i class="fa fa-check"></i><b>14</b> Example 3</a>
<ul>
<li class="chapter" data-level="14.1" data-path="example-3.html"><a href="example-3.html#reinforcement-learning-framework"><i class="fa fa-check"></i><b>14.1</b> Reinforcement learning framework</a></li>
<li class="chapter" data-level="14.2" data-path="example-3.html"><a href="example-3.html#estimating-the-state-value-function"><i class="fa fa-check"></i><b>14.2</b> Estimating the state-value function</a></li>
<li class="chapter" data-level="14.3" data-path="example-3.html"><a href="example-3.html#temporal-difference-td-learning"><i class="fa fa-check"></i><b>14.3</b> Temporal difference (TD) learning</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="example-3.html"><a href="example-3.html#td-rl-model-of-classical-conditioning"><i class="fa fa-check"></i><b>14.3.1</b> TD RL model of classical conditioning</a></li>
<li class="chapter" data-level="14.3.2" data-path="example-3.html"><a href="example-3.html#td-rl-as-the-learning-signal-in-a-spiking-network"><i class="fa fa-check"></i><b>14.3.2</b> TD RL as the learning signal in a spiking network</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="example-3.html"><a href="example-3.html#td0-for-estimating-v_pi"><i class="fa fa-check"></i><b>14.4</b> TD(0) for estimating <span class="math inline">\(v_{\pi}\)</span></a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="example-3.html"><a href="example-3.html#td-in-a-simple-2-arm-bandit-task"><i class="fa fa-check"></i><b>14.4.1</b> TD in a simple 2-arm bandit task</a></li>
<li class="chapter" data-level="14.4.2" data-path="example-3.html"><a href="example-3.html#action-selection-policy"><i class="fa fa-check"></i><b>14.4.2</b> Action selection policy</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="example-3.html"><a href="example-3.html#sarsa-for-estimating-q"><i class="fa fa-check"></i><b>14.5</b> SARSA for estimating <span class="math inline">\(Q\)</span></a></li>
<li class="chapter" data-level="14.6" data-path="example-3.html"><a href="example-3.html#q-learning-for-estimating-pi"><i class="fa fa-check"></i><b>14.6</b> Q-learning for estimating <span class="math inline">\(\pi\)</span></a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="example-3.html"><a href="example-3.html#q-learning-applied-to-instrumental-conditioning"><i class="fa fa-check"></i><b>14.6.1</b> Q-learning applied to instrumental conditioning</a></li>
<li class="chapter" data-level="14.6.2" data-path="example-3.html"><a href="example-3.html#q-learning-applied-to-instrumental-conditioning-2"><i class="fa fa-check"></i><b>14.6.2</b> Q-learning applied to instrumental conditioning 2</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="example-3.html"><a href="example-3.html#dyna-q-model-based-rl"><i class="fa fa-check"></i><b>14.7</b> Dyna-Q: Model-based RL</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="example-3.html"><a href="example-3.html#dyna-q-applied-to-instrumental-conditioning"><i class="fa fa-check"></i><b>14.7.1</b> Dyna-Q applied to instrumental conditioning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>15</b> supervised learning</a></li>
<li class="chapter" data-level="16" data-path="supervised-learning-1.html"><a href="supervised-learning-1.html"><i class="fa fa-check"></i><b>16</b> Supervised Learning</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Computational Neuroscience</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-1" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Example 1<a href="example-1.html#example-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li><p>We will simulate a two neuron network in which neuron 1
projects to neuron 2, the first neuron is driven by an
external input, and the connection weight between neuron 1
and neuron 2 is subject to reinforcement learning.</p></li>
<li><p>We will use the following <code>python</code> code based on the
previous lecture.</p></li>
<li><p>The key additions to the code from previous lecture are
mostly found in the <code>update_weight_rl()</code> function.</p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="example-1.html#cb30-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="example-1.html#cb30-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb30-3"><a href="example-1.html#cb30-3" tabindex="-1"></a><span class="im">import</span> matplotlib.gridspec <span class="im">as</span> gridspec</span>
<span id="cb30-4"><a href="example-1.html#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="example-1.html#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="example-1.html#cb30-6" tabindex="-1"></a><span class="kw">def</span> init_arrays():</span>
<span id="cb30-7"><a href="example-1.html#cb30-7" tabindex="-1"></a></span>
<span id="cb30-8"><a href="example-1.html#cb30-8" tabindex="-1"></a>    r_predicted <span class="op">=</span> np.zeros(n_trials)</span>
<span id="cb30-9"><a href="example-1.html#cb30-9" tabindex="-1"></a>    r_obtained <span class="op">=</span> np.zeros(n_trials)</span>
<span id="cb30-10"><a href="example-1.html#cb30-10" tabindex="-1"></a>    delta <span class="op">=</span> np.zeros(n_trials)</span>
<span id="cb30-11"><a href="example-1.html#cb30-11" tabindex="-1"></a></span>
<span id="cb30-12"><a href="example-1.html#cb30-12" tabindex="-1"></a>    r_obtained[:n_trials <span class="op">//</span> <span class="dv">4</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-13"><a href="example-1.html#cb30-13" tabindex="-1"></a>    r_obtained[(<span class="dv">2</span> <span class="op">*</span> n_trials <span class="op">//</span> <span class="dv">4</span>):(<span class="dv">3</span> <span class="op">*</span> n_trials <span class="op">//</span> <span class="dv">4</span>)] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-14"><a href="example-1.html#cb30-14" tabindex="-1"></a></span>
<span id="cb30-15"><a href="example-1.html#cb30-15" tabindex="-1"></a>    v1 <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-16"><a href="example-1.html#cb30-16" tabindex="-1"></a>    u1 <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-17"><a href="example-1.html#cb30-17" tabindex="-1"></a>    g1 <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-18"><a href="example-1.html#cb30-18" tabindex="-1"></a>    spike1 <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-19"><a href="example-1.html#cb30-19" tabindex="-1"></a>    v1[<span class="dv">0</span>] <span class="op">=</span> vr</span>
<span id="cb30-20"><a href="example-1.html#cb30-20" tabindex="-1"></a></span>
<span id="cb30-21"><a href="example-1.html#cb30-21" tabindex="-1"></a>    v2 <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-22"><a href="example-1.html#cb30-22" tabindex="-1"></a>    u2 <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-23"><a href="example-1.html#cb30-23" tabindex="-1"></a>    g2 <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-24"><a href="example-1.html#cb30-24" tabindex="-1"></a>    spike2 <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-25"><a href="example-1.html#cb30-25" tabindex="-1"></a>    v2[<span class="dv">0</span>] <span class="op">=</span> vr</span>
<span id="cb30-26"><a href="example-1.html#cb30-26" tabindex="-1"></a></span>
<span id="cb30-27"><a href="example-1.html#cb30-27" tabindex="-1"></a>    w_01 <span class="op">=</span> <span class="fl">0.4</span> <span class="op">*</span> np.ones(n_trials)</span>
<span id="cb30-28"><a href="example-1.html#cb30-28" tabindex="-1"></a>    w_12 <span class="op">=</span> <span class="fl">0.4</span> <span class="op">*</span> np.ones(n_trials)</span>
<span id="cb30-29"><a href="example-1.html#cb30-29" tabindex="-1"></a></span>
<span id="cb30-30"><a href="example-1.html#cb30-30" tabindex="-1"></a>    g_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb30-31"><a href="example-1.html#cb30-31" tabindex="-1"></a>    v1_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb30-32"><a href="example-1.html#cb30-32" tabindex="-1"></a>    g1_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb30-33"><a href="example-1.html#cb30-33" tabindex="-1"></a>    v2_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb30-34"><a href="example-1.html#cb30-34" tabindex="-1"></a>    g2_record <span class="op">=</span> np.zeros((n_trials, n))</span>
<span id="cb30-35"><a href="example-1.html#cb30-35" tabindex="-1"></a></span>
<span id="cb30-36"><a href="example-1.html#cb30-36" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb30-37"><a href="example-1.html#cb30-37" tabindex="-1"></a>        <span class="st">&#39;r_predicted&#39;</span>: r_predicted,</span>
<span id="cb30-38"><a href="example-1.html#cb30-38" tabindex="-1"></a>        <span class="st">&#39;r_obtained&#39;</span>: r_obtained,</span>
<span id="cb30-39"><a href="example-1.html#cb30-39" tabindex="-1"></a>        <span class="st">&#39;delta&#39;</span>: delta,</span>
<span id="cb30-40"><a href="example-1.html#cb30-40" tabindex="-1"></a>        <span class="st">&#39;v1&#39;</span>: v1,</span>
<span id="cb30-41"><a href="example-1.html#cb30-41" tabindex="-1"></a>        <span class="st">&#39;u1&#39;</span>: u1,</span>
<span id="cb30-42"><a href="example-1.html#cb30-42" tabindex="-1"></a>        <span class="st">&#39;g1&#39;</span>: g1,</span>
<span id="cb30-43"><a href="example-1.html#cb30-43" tabindex="-1"></a>        <span class="st">&#39;spike1&#39;</span>: spike1,</span>
<span id="cb30-44"><a href="example-1.html#cb30-44" tabindex="-1"></a>        <span class="st">&#39;v2&#39;</span>: v2,</span>
<span id="cb30-45"><a href="example-1.html#cb30-45" tabindex="-1"></a>        <span class="st">&#39;u2&#39;</span>: u2,</span>
<span id="cb30-46"><a href="example-1.html#cb30-46" tabindex="-1"></a>        <span class="st">&#39;g2&#39;</span>: g2,</span>
<span id="cb30-47"><a href="example-1.html#cb30-47" tabindex="-1"></a>        <span class="st">&#39;spike2&#39;</span>: spike2,</span>
<span id="cb30-48"><a href="example-1.html#cb30-48" tabindex="-1"></a>        <span class="st">&#39;w_01&#39;</span>: w_01,</span>
<span id="cb30-49"><a href="example-1.html#cb30-49" tabindex="-1"></a>        <span class="st">&#39;w_12&#39;</span>: w_12,</span>
<span id="cb30-50"><a href="example-1.html#cb30-50" tabindex="-1"></a>        <span class="st">&#39;g_record&#39;</span>: g_record,</span>
<span id="cb30-51"><a href="example-1.html#cb30-51" tabindex="-1"></a>        <span class="st">&#39;v1_record&#39;</span>: v1_record,</span>
<span id="cb30-52"><a href="example-1.html#cb30-52" tabindex="-1"></a>        <span class="st">&#39;g1_record&#39;</span>: g1_record,</span>
<span id="cb30-53"><a href="example-1.html#cb30-53" tabindex="-1"></a>        <span class="st">&#39;v2_record&#39;</span>: v2_record,</span>
<span id="cb30-54"><a href="example-1.html#cb30-54" tabindex="-1"></a>        <span class="st">&#39;g2_record&#39;</span>: g2_record</span>
<span id="cb30-55"><a href="example-1.html#cb30-55" tabindex="-1"></a>    }</span>
<span id="cb30-56"><a href="example-1.html#cb30-56" tabindex="-1"></a></span>
<span id="cb30-57"><a href="example-1.html#cb30-57" tabindex="-1"></a></span>
<span id="cb30-58"><a href="example-1.html#cb30-58" tabindex="-1"></a><span class="kw">def</span> plot_results():</span>
<span id="cb30-59"><a href="example-1.html#cb30-59" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb30-60"><a href="example-1.html#cb30-60" tabindex="-1"></a>    gs <span class="op">=</span> gridspec.GridSpec(<span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb30-61"><a href="example-1.html#cb30-61" tabindex="-1"></a></span>
<span id="cb30-62"><a href="example-1.html#cb30-62" tabindex="-1"></a>    ax00 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb30-63"><a href="example-1.html#cb30-63" tabindex="-1"></a>    ax10 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb30-64"><a href="example-1.html#cb30-64" tabindex="-1"></a>    ax20 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">2</span>, <span class="dv">0</span>])</span>
<span id="cb30-65"><a href="example-1.html#cb30-65" tabindex="-1"></a>    ax01 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb30-66"><a href="example-1.html#cb30-66" tabindex="-1"></a>    ax11 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb30-67"><a href="example-1.html#cb30-67" tabindex="-1"></a>    ax21 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb30-68"><a href="example-1.html#cb30-68" tabindex="-1"></a>    ax3 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">3</span>, :])</span>
<span id="cb30-69"><a href="example-1.html#cb30-69" tabindex="-1"></a>    ax4 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">4</span>, :])</span>
<span id="cb30-70"><a href="example-1.html#cb30-70" tabindex="-1"></a></span>
<span id="cb30-71"><a href="example-1.html#cb30-71" tabindex="-1"></a>    ax1 <span class="op">=</span> ax00</span>
<span id="cb30-72"><a href="example-1.html#cb30-72" tabindex="-1"></a>    ax2 <span class="op">=</span> ax00.twinx()</span>
<span id="cb30-73"><a href="example-1.html#cb30-73" tabindex="-1"></a>    ax2.plot(t, g_record[<span class="dv">0</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;external g&#39;</span>)</span>
<span id="cb30-74"><a href="example-1.html#cb30-74" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb30-75"><a href="example-1.html#cb30-75" tabindex="-1"></a>    ax1.set_title(<span class="st">&#39;Trial 1&#39;</span>)</span>
<span id="cb30-76"><a href="example-1.html#cb30-76" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb30-77"><a href="example-1.html#cb30-77" tabindex="-1"></a></span>
<span id="cb30-78"><a href="example-1.html#cb30-78" tabindex="-1"></a>    ax1 <span class="op">=</span> ax10</span>
<span id="cb30-79"><a href="example-1.html#cb30-79" tabindex="-1"></a>    ax2 <span class="op">=</span> ax10.twinx()</span>
<span id="cb30-80"><a href="example-1.html#cb30-80" tabindex="-1"></a>    ax1.plot(t, v1_record[<span class="dv">0</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;v1&#39;</span>)</span>
<span id="cb30-81"><a href="example-1.html#cb30-81" tabindex="-1"></a>    ax2.plot(t, g1_record[<span class="dv">0</span>], <span class="st">&#39;C1&#39;</span>, label<span class="op">=</span><span class="st">&#39;g1&#39;</span>)</span>
<span id="cb30-82"><a href="example-1.html#cb30-82" tabindex="-1"></a>    ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb30-83"><a href="example-1.html#cb30-83" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb30-84"><a href="example-1.html#cb30-84" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb30-85"><a href="example-1.html#cb30-85" tabindex="-1"></a></span>
<span id="cb30-86"><a href="example-1.html#cb30-86" tabindex="-1"></a>    ax1 <span class="op">=</span> ax20</span>
<span id="cb30-87"><a href="example-1.html#cb30-87" tabindex="-1"></a>    ax2 <span class="op">=</span> ax20.twinx()</span>
<span id="cb30-88"><a href="example-1.html#cb30-88" tabindex="-1"></a>    ax1.plot(t, v2_record[<span class="dv">0</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;v2&#39;</span>)</span>
<span id="cb30-89"><a href="example-1.html#cb30-89" tabindex="-1"></a>    ax2.plot(t, g2_record[<span class="dv">0</span>], <span class="st">&#39;C1&#39;</span>, label<span class="op">=</span><span class="st">&#39;g2&#39;</span>)</span>
<span id="cb30-90"><a href="example-1.html#cb30-90" tabindex="-1"></a>    ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb30-91"><a href="example-1.html#cb30-91" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb30-92"><a href="example-1.html#cb30-92" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb30-93"><a href="example-1.html#cb30-93" tabindex="-1"></a></span>
<span id="cb30-94"><a href="example-1.html#cb30-94" tabindex="-1"></a>    ax1 <span class="op">=</span> ax01</span>
<span id="cb30-95"><a href="example-1.html#cb30-95" tabindex="-1"></a>    ax2 <span class="op">=</span> ax01.twinx()</span>
<span id="cb30-96"><a href="example-1.html#cb30-96" tabindex="-1"></a>    ax2.plot(t, g_record[<span class="dv">0</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;external g&#39;</span>)</span>
<span id="cb30-97"><a href="example-1.html#cb30-97" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb30-98"><a href="example-1.html#cb30-98" tabindex="-1"></a>    ax1.set_title(<span class="st">&#39;Trial n&#39;</span>)</span>
<span id="cb30-99"><a href="example-1.html#cb30-99" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb30-100"><a href="example-1.html#cb30-100" tabindex="-1"></a></span>
<span id="cb30-101"><a href="example-1.html#cb30-101" tabindex="-1"></a>    ax1 <span class="op">=</span> ax11</span>
<span id="cb30-102"><a href="example-1.html#cb30-102" tabindex="-1"></a>    ax2 <span class="op">=</span> ax11.twinx()</span>
<span id="cb30-103"><a href="example-1.html#cb30-103" tabindex="-1"></a>    ax1.plot(t, v1_record[<span class="op">-</span><span class="dv">2</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;v1&#39;</span>)</span>
<span id="cb30-104"><a href="example-1.html#cb30-104" tabindex="-1"></a>    ax2.plot(t, g1_record[<span class="op">-</span><span class="dv">2</span>], <span class="st">&#39;C1&#39;</span>, label<span class="op">=</span><span class="st">&#39;g1&#39;</span>)</span>
<span id="cb30-105"><a href="example-1.html#cb30-105" tabindex="-1"></a>    ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb30-106"><a href="example-1.html#cb30-106" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb30-107"><a href="example-1.html#cb30-107" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb30-108"><a href="example-1.html#cb30-108" tabindex="-1"></a></span>
<span id="cb30-109"><a href="example-1.html#cb30-109" tabindex="-1"></a>    ax1 <span class="op">=</span> ax21</span>
<span id="cb30-110"><a href="example-1.html#cb30-110" tabindex="-1"></a>    ax2 <span class="op">=</span> ax21.twinx()</span>
<span id="cb30-111"><a href="example-1.html#cb30-111" tabindex="-1"></a>    ax1.plot(t, v2_record[<span class="op">-</span><span class="dv">2</span>], <span class="st">&#39;C0&#39;</span>, label<span class="op">=</span><span class="st">&#39;v2&#39;</span>)</span>
<span id="cb30-112"><a href="example-1.html#cb30-112" tabindex="-1"></a>    ax2.plot(t, g2_record[<span class="op">-</span><span class="dv">2</span>], <span class="st">&#39;C1&#39;</span>, label<span class="op">=</span><span class="st">&#39;g2&#39;</span>)</span>
<span id="cb30-113"><a href="example-1.html#cb30-113" tabindex="-1"></a>    ax1.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb30-114"><a href="example-1.html#cb30-114" tabindex="-1"></a>    ax2.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb30-115"><a href="example-1.html#cb30-115" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;time (t)&#39;</span>)</span>
<span id="cb30-116"><a href="example-1.html#cb30-116" tabindex="-1"></a></span>
<span id="cb30-117"><a href="example-1.html#cb30-117" tabindex="-1"></a>    ax3.plot(np.arange(<span class="dv">0</span>, n_trials, <span class="dv">1</span>), r_obtained, label<span class="op">=</span><span class="st">&#39;r_obtained&#39;</span>)</span>
<span id="cb30-118"><a href="example-1.html#cb30-118" tabindex="-1"></a>    ax3.plot(np.arange(<span class="dv">0</span>, n_trials, <span class="dv">1</span>), r_predicted, label<span class="op">=</span><span class="st">&#39;r_predicted&#39;</span>)</span>
<span id="cb30-119"><a href="example-1.html#cb30-119" tabindex="-1"></a>    ax3.plot(np.arange(<span class="dv">0</span>, n_trials, <span class="dv">1</span>), delta, label<span class="op">=</span><span class="st">&#39;delta&#39;</span>)</span>
<span id="cb30-120"><a href="example-1.html#cb30-120" tabindex="-1"></a>    ax3.set_xlabel(<span class="st">&#39;Trial&#39;</span>)</span>
<span id="cb30-121"><a href="example-1.html#cb30-121" tabindex="-1"></a>    ax3.set_ylabel(<span class="st">&#39;&#39;</span>)</span>
<span id="cb30-122"><a href="example-1.html#cb30-122" tabindex="-1"></a>    ax3.legend()</span>
<span id="cb30-123"><a href="example-1.html#cb30-123" tabindex="-1"></a></span>
<span id="cb30-124"><a href="example-1.html#cb30-124" tabindex="-1"></a>    ax4.plot(np.arange(<span class="dv">0</span>, n_trials, <span class="dv">1</span>), w_12)</span>
<span id="cb30-125"><a href="example-1.html#cb30-125" tabindex="-1"></a>    ax4.set_xlabel(<span class="st">&#39;Trial&#39;</span>)</span>
<span id="cb30-126"><a href="example-1.html#cb30-126" tabindex="-1"></a>    ax4.set_ylabel(<span class="st">&#39;Synaptic Weight (w)&#39;</span>)</span>
<span id="cb30-127"><a href="example-1.html#cb30-127" tabindex="-1"></a></span>
<span id="cb30-128"><a href="example-1.html#cb30-128" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb30-129"><a href="example-1.html#cb30-129" tabindex="-1"></a>    plt.show()</span>
<span id="cb30-130"><a href="example-1.html#cb30-130" tabindex="-1"></a></span>
<span id="cb30-131"><a href="example-1.html#cb30-131" tabindex="-1"></a></span>
<span id="cb30-132"><a href="example-1.html#cb30-132" tabindex="-1"></a><span class="kw">def</span> simulate_network(update_weight_func):</span>
<span id="cb30-133"><a href="example-1.html#cb30-133" tabindex="-1"></a>    <span class="kw">global</span> trl, r_obtained, r_predicted</span>
<span id="cb30-134"><a href="example-1.html#cb30-134" tabindex="-1"></a></span>
<span id="cb30-135"><a href="example-1.html#cb30-135" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_trials <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb30-136"><a href="example-1.html#cb30-136" tabindex="-1"></a>        trl <span class="op">=</span> j</span>
<span id="cb30-137"><a href="example-1.html#cb30-137" tabindex="-1"></a></span>
<span id="cb30-138"><a href="example-1.html#cb30-138" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb30-139"><a href="example-1.html#cb30-139" tabindex="-1"></a></span>
<span id="cb30-140"><a href="example-1.html#cb30-140" tabindex="-1"></a>            dt <span class="op">=</span> t[i] <span class="op">-</span> t[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb30-141"><a href="example-1.html#cb30-141" tabindex="-1"></a></span>
<span id="cb30-142"><a href="example-1.html#cb30-142" tabindex="-1"></a>            <span class="co"># external input</span></span>
<span id="cb30-143"><a href="example-1.html#cb30-143" tabindex="-1"></a>            dgdt <span class="op">=</span> (<span class="op">-</span>g[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> psp_amp <span class="op">*</span> spike[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> psp_decay</span>
<span id="cb30-144"><a href="example-1.html#cb30-144" tabindex="-1"></a>            g[i] <span class="op">=</span> g[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dgdt <span class="op">*</span> dt</span>
<span id="cb30-145"><a href="example-1.html#cb30-145" tabindex="-1"></a></span>
<span id="cb30-146"><a href="example-1.html#cb30-146" tabindex="-1"></a>            <span class="co"># neuron 1</span></span>
<span id="cb30-147"><a href="example-1.html#cb30-147" tabindex="-1"></a>            dvdt1 <span class="op">=</span> (k <span class="op">*</span> (v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vr) <span class="op">*</span></span>
<span id="cb30-148"><a href="example-1.html#cb30-148" tabindex="-1"></a>                     (v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vt) <span class="op">-</span> u1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> w_01[trl] <span class="op">*</span> g[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> C</span>
<span id="cb30-149"><a href="example-1.html#cb30-149" tabindex="-1"></a>            dudt1 <span class="op">=</span> a <span class="op">*</span> (b <span class="op">*</span> (v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vr) <span class="op">-</span> u1[i <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb30-150"><a href="example-1.html#cb30-150" tabindex="-1"></a>            dgdt1 <span class="op">=</span> (<span class="op">-</span>g1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> psp_amp <span class="op">*</span> spike1[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> psp_decay</span>
<span id="cb30-151"><a href="example-1.html#cb30-151" tabindex="-1"></a>            v1[i] <span class="op">=</span> v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dvdt1 <span class="op">*</span> dt</span>
<span id="cb30-152"><a href="example-1.html#cb30-152" tabindex="-1"></a>            u1[i] <span class="op">=</span> u1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dudt1 <span class="op">*</span> dt</span>
<span id="cb30-153"><a href="example-1.html#cb30-153" tabindex="-1"></a>            g1[i] <span class="op">=</span> g1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dgdt1 <span class="op">*</span> dt</span>
<span id="cb30-154"><a href="example-1.html#cb30-154" tabindex="-1"></a>            <span class="cf">if</span> v1[i] <span class="op">&gt;=</span> vpeak:</span>
<span id="cb30-155"><a href="example-1.html#cb30-155" tabindex="-1"></a>                v1[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> vpeak</span>
<span id="cb30-156"><a href="example-1.html#cb30-156" tabindex="-1"></a>                v1[i] <span class="op">=</span> c</span>
<span id="cb30-157"><a href="example-1.html#cb30-157" tabindex="-1"></a>                u1[i] <span class="op">=</span> u1[i] <span class="op">+</span> d</span>
<span id="cb30-158"><a href="example-1.html#cb30-158" tabindex="-1"></a>                spike1[i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-159"><a href="example-1.html#cb30-159" tabindex="-1"></a></span>
<span id="cb30-160"><a href="example-1.html#cb30-160" tabindex="-1"></a>            <span class="co"># neuron 2</span></span>
<span id="cb30-161"><a href="example-1.html#cb30-161" tabindex="-1"></a>            dvdt2 <span class="op">=</span> (k <span class="op">*</span> (v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vr) <span class="op">*</span></span>
<span id="cb30-162"><a href="example-1.html#cb30-162" tabindex="-1"></a>                     (v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vt) <span class="op">-</span> u2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> w_12[trl] <span class="op">*</span> g1[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> C</span>
<span id="cb30-163"><a href="example-1.html#cb30-163" tabindex="-1"></a>            dudt2 <span class="op">=</span> a <span class="op">*</span> (b <span class="op">*</span> (v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> vr) <span class="op">-</span> u2[i <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb30-164"><a href="example-1.html#cb30-164" tabindex="-1"></a>            dgdt2 <span class="op">=</span> (<span class="op">-</span>g2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> psp_amp <span class="op">*</span> spike2[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> psp_decay</span>
<span id="cb30-165"><a href="example-1.html#cb30-165" tabindex="-1"></a>            v2[i] <span class="op">=</span> v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dvdt2 <span class="op">*</span> dt</span>
<span id="cb30-166"><a href="example-1.html#cb30-166" tabindex="-1"></a>            u2[i] <span class="op">=</span> u2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dudt2 <span class="op">*</span> dt</span>
<span id="cb30-167"><a href="example-1.html#cb30-167" tabindex="-1"></a>            g2[i] <span class="op">=</span> g2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dgdt2 <span class="op">*</span> dt</span>
<span id="cb30-168"><a href="example-1.html#cb30-168" tabindex="-1"></a>            <span class="cf">if</span> v2[i] <span class="op">&gt;=</span> vpeak:</span>
<span id="cb30-169"><a href="example-1.html#cb30-169" tabindex="-1"></a>                v2[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> vpeak</span>
<span id="cb30-170"><a href="example-1.html#cb30-170" tabindex="-1"></a>                v2[i] <span class="op">=</span> c</span>
<span id="cb30-171"><a href="example-1.html#cb30-171" tabindex="-1"></a>                u2[i] <span class="op">=</span> u2[i] <span class="op">+</span> d</span>
<span id="cb30-172"><a href="example-1.html#cb30-172" tabindex="-1"></a>                spike2[i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-173"><a href="example-1.html#cb30-173" tabindex="-1"></a></span>
<span id="cb30-174"><a href="example-1.html#cb30-174" tabindex="-1"></a>        <span class="co"># update synaptic weights</span></span>
<span id="cb30-175"><a href="example-1.html#cb30-175" tabindex="-1"></a>        delta_w <span class="op">=</span> update_weight_func()</span>
<span id="cb30-176"><a href="example-1.html#cb30-176" tabindex="-1"></a>        w_12[trl <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> w_12[trl] <span class="op">+</span> delta_w</span>
<span id="cb30-177"><a href="example-1.html#cb30-177" tabindex="-1"></a></span>
<span id="cb30-178"><a href="example-1.html#cb30-178" tabindex="-1"></a>        <span class="co"># store trial info</span></span>
<span id="cb30-179"><a href="example-1.html#cb30-179" tabindex="-1"></a>        g_record[trl, :] <span class="op">=</span> g</span>
<span id="cb30-180"><a href="example-1.html#cb30-180" tabindex="-1"></a>        v1_record[trl, :] <span class="op">=</span> v1</span>
<span id="cb30-181"><a href="example-1.html#cb30-181" tabindex="-1"></a>        g1_record[trl, :] <span class="op">=</span> g1</span>
<span id="cb30-182"><a href="example-1.html#cb30-182" tabindex="-1"></a>        v2_record[trl, :] <span class="op">=</span> v2</span>
<span id="cb30-183"><a href="example-1.html#cb30-183" tabindex="-1"></a>        g2_record[trl, :] <span class="op">=</span> g2</span>
<span id="cb30-184"><a href="example-1.html#cb30-184" tabindex="-1"></a></span>
<span id="cb30-185"><a href="example-1.html#cb30-185" tabindex="-1"></a>    plot_results()</span>
<span id="cb30-186"><a href="example-1.html#cb30-186" tabindex="-1"></a></span>
<span id="cb30-187"><a href="example-1.html#cb30-187" tabindex="-1"></a></span>
<span id="cb30-188"><a href="example-1.html#cb30-188" tabindex="-1"></a><span class="kw">def</span> update_weight_rl():</span>
<span id="cb30-189"><a href="example-1.html#cb30-189" tabindex="-1"></a>    <span class="kw">global</span> trl, r_obtained, r_predicted</span>
<span id="cb30-190"><a href="example-1.html#cb30-190" tabindex="-1"></a></span>
<span id="cb30-191"><a href="example-1.html#cb30-191" tabindex="-1"></a>    delta[trl] <span class="op">=</span> r_obtained[trl] <span class="op">-</span> r_predicted[trl]</span>
<span id="cb30-192"><a href="example-1.html#cb30-192" tabindex="-1"></a>    r_predicted[trl <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> r_predicted[trl] <span class="op">+</span> gamma <span class="op">*</span> delta[trl]</span>
<span id="cb30-193"><a href="example-1.html#cb30-193" tabindex="-1"></a></span>
<span id="cb30-194"><a href="example-1.html#cb30-194" tabindex="-1"></a>    pre <span class="op">=</span> g1.<span class="bu">sum</span>()</span>
<span id="cb30-195"><a href="example-1.html#cb30-195" tabindex="-1"></a>    post <span class="op">=</span> g2.<span class="bu">sum</span>()</span>
<span id="cb30-196"><a href="example-1.html#cb30-196" tabindex="-1"></a></span>
<span id="cb30-197"><a href="example-1.html#cb30-197" tabindex="-1"></a>    delta_w <span class="op">=</span> alpha <span class="op">*</span> pre <span class="op">*</span> post <span class="op">*</span> delta[trl]</span>
<span id="cb30-198"><a href="example-1.html#cb30-198" tabindex="-1"></a></span>
<span id="cb30-199"><a href="example-1.html#cb30-199" tabindex="-1"></a>    <span class="cf">return</span> delta_w</span>
<span id="cb30-200"><a href="example-1.html#cb30-200" tabindex="-1"></a></span>
<span id="cb30-201"><a href="example-1.html#cb30-201" tabindex="-1"></a></span>
<span id="cb30-202"><a href="example-1.html#cb30-202" tabindex="-1"></a>n_trials <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb30-203"><a href="example-1.html#cb30-203" tabindex="-1"></a>trl <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb30-204"><a href="example-1.html#cb30-204" tabindex="-1"></a></span>
<span id="cb30-205"><a href="example-1.html#cb30-205" tabindex="-1"></a>tau <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb30-206"><a href="example-1.html#cb30-206" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb30-207"><a href="example-1.html#cb30-207" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, T, tau)</span>
<span id="cb30-208"><a href="example-1.html#cb30-208" tabindex="-1"></a>n <span class="op">=</span> t.shape[<span class="dv">0</span>]</span>
<span id="cb30-209"><a href="example-1.html#cb30-209" tabindex="-1"></a></span>
<span id="cb30-210"><a href="example-1.html#cb30-210" tabindex="-1"></a>C <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb30-211"><a href="example-1.html#cb30-211" tabindex="-1"></a>vr <span class="op">=</span> <span class="op">-</span><span class="dv">80</span></span>
<span id="cb30-212"><a href="example-1.html#cb30-212" tabindex="-1"></a>vt <span class="op">=</span> <span class="op">-</span><span class="dv">25</span></span>
<span id="cb30-213"><a href="example-1.html#cb30-213" tabindex="-1"></a>vpeak <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb30-214"><a href="example-1.html#cb30-214" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-215"><a href="example-1.html#cb30-215" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb30-216"><a href="example-1.html#cb30-216" tabindex="-1"></a>b <span class="op">=</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb30-217"><a href="example-1.html#cb30-217" tabindex="-1"></a>c <span class="op">=</span> <span class="op">-</span><span class="dv">55</span></span>
<span id="cb30-218"><a href="example-1.html#cb30-218" tabindex="-1"></a>d <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb30-219"><a href="example-1.html#cb30-219" tabindex="-1"></a></span>
<span id="cb30-220"><a href="example-1.html#cb30-220" tabindex="-1"></a>psp_amp <span class="op">=</span> <span class="fl">1e5</span></span>
<span id="cb30-221"><a href="example-1.html#cb30-221" tabindex="-1"></a>psp_decay <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb30-222"><a href="example-1.html#cb30-222" tabindex="-1"></a></span>
<span id="cb30-223"><a href="example-1.html#cb30-223" tabindex="-1"></a>g <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-224"><a href="example-1.html#cb30-224" tabindex="-1"></a>spike <span class="op">=</span> np.zeros(n)</span>
<span id="cb30-225"><a href="example-1.html#cb30-225" tabindex="-1"></a>spike[<span class="dv">200</span>:<span class="dv">800</span>:<span class="dv">20</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-226"><a href="example-1.html#cb30-226" tabindex="-1"></a></span>
<span id="cb30-227"><a href="example-1.html#cb30-227" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb30-228"><a href="example-1.html#cb30-228" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">3e-14</span></span>
<span id="cb30-229"><a href="example-1.html#cb30-229" tabindex="-1"></a>gamma <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb30-230"><a href="example-1.html#cb30-230" tabindex="-1"></a></span>
<span id="cb30-231"><a href="example-1.html#cb30-231" tabindex="-1"></a>array_dict <span class="op">=</span> init_arrays()</span>
<span id="cb30-232"><a href="example-1.html#cb30-232" tabindex="-1"></a></span>
<span id="cb30-233"><a href="example-1.html#cb30-233" tabindex="-1"></a>r_predicted <span class="op">=</span> array_dict[<span class="st">&#39;r_predicted&#39;</span>]</span>
<span id="cb30-234"><a href="example-1.html#cb30-234" tabindex="-1"></a>r_obtained <span class="op">=</span> array_dict[<span class="st">&#39;r_obtained&#39;</span>]</span>
<span id="cb30-235"><a href="example-1.html#cb30-235" tabindex="-1"></a>delta <span class="op">=</span> array_dict[<span class="st">&#39;delta&#39;</span>]</span>
<span id="cb30-236"><a href="example-1.html#cb30-236" tabindex="-1"></a>v1 <span class="op">=</span> array_dict[<span class="st">&#39;v1&#39;</span>]</span>
<span id="cb30-237"><a href="example-1.html#cb30-237" tabindex="-1"></a>u1 <span class="op">=</span> array_dict[<span class="st">&#39;u1&#39;</span>]</span>
<span id="cb30-238"><a href="example-1.html#cb30-238" tabindex="-1"></a>g1 <span class="op">=</span> array_dict[<span class="st">&#39;g1&#39;</span>]</span>
<span id="cb30-239"><a href="example-1.html#cb30-239" tabindex="-1"></a>spike1 <span class="op">=</span> array_dict[<span class="st">&#39;spike1&#39;</span>]</span>
<span id="cb30-240"><a href="example-1.html#cb30-240" tabindex="-1"></a>v2 <span class="op">=</span> array_dict[<span class="st">&#39;v2&#39;</span>]</span>
<span id="cb30-241"><a href="example-1.html#cb30-241" tabindex="-1"></a>u2 <span class="op">=</span> array_dict[<span class="st">&#39;u2&#39;</span>]</span>
<span id="cb30-242"><a href="example-1.html#cb30-242" tabindex="-1"></a>g2 <span class="op">=</span> array_dict[<span class="st">&#39;g2&#39;</span>]</span>
<span id="cb30-243"><a href="example-1.html#cb30-243" tabindex="-1"></a>spike2 <span class="op">=</span> array_dict[<span class="st">&#39;spike2&#39;</span>]</span>
<span id="cb30-244"><a href="example-1.html#cb30-244" tabindex="-1"></a>w_01 <span class="op">=</span> array_dict[<span class="st">&#39;w_01&#39;</span>]</span>
<span id="cb30-245"><a href="example-1.html#cb30-245" tabindex="-1"></a>w_12 <span class="op">=</span> array_dict[<span class="st">&#39;w_12&#39;</span>]</span>
<span id="cb30-246"><a href="example-1.html#cb30-246" tabindex="-1"></a>g_record <span class="op">=</span> array_dict[<span class="st">&#39;g_record&#39;</span>]</span>
<span id="cb30-247"><a href="example-1.html#cb30-247" tabindex="-1"></a>v1_record <span class="op">=</span> array_dict[<span class="st">&#39;v1_record&#39;</span>]</span>
<span id="cb30-248"><a href="example-1.html#cb30-248" tabindex="-1"></a>g1_record <span class="op">=</span> array_dict[<span class="st">&#39;g1_record&#39;</span>]</span>
<span id="cb30-249"><a href="example-1.html#cb30-249" tabindex="-1"></a>v2_record <span class="op">=</span> array_dict[<span class="st">&#39;v2_record&#39;</span>]</span>
<span id="cb30-250"><a href="example-1.html#cb30-250" tabindex="-1"></a>g2_record <span class="op">=</span> array_dict[<span class="st">&#39;g2_record&#39;</span>]</span>
<span id="cb30-251"><a href="example-1.html#cb30-251" tabindex="-1"></a></span>
<span id="cb30-252"><a href="example-1.html#cb30-252" tabindex="-1"></a>update_weight_func <span class="op">=</span> update_weight_rl</span>
<span id="cb30-253"><a href="example-1.html#cb30-253" tabindex="-1"></a>simulate_network(update_weight_func)</span></code></pre></div>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-36-1.png" width="768" /></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reinforcement-learning-rule.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"depth": 2
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
